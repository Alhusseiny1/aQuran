!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var u=function(n,t){if(n.forEach)return n.forEach(t);for(var e=0;e<n.length;e+=1)t(n[e],e,n)},i=function(n,t){if(n.map)return n.map(t);var e=[];return u(n,function(n,r,u){e.push(t(n,r,u))}),e},c=function(n,t,e){return n.reduce?n.reduce(t,e):(u(n,function(n,r,u){e=t(e,n,r,u)}),e)},o=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate="undefined"!=typeof setImmediate?function(n){setImmediate(n)}:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){if(r=r||function(){},!t.length)return r();var i=0;u(t,function(u){e(u,n(function(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r(null))}))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,u=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e(null):u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=a(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var a=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var u=0,i=0,c=0;!function o(){if(u>=t.length)return r();for(;n>c&&i<t.length;)i+=1,c+=1,e(t[i-1],function(n){n?(r(n),r=function(){}):(u+=1,c-=1,u>=t.length?r():o())})}()}},l=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},f=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a(n)].concat(e))}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},p=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})};r.map=l(p),r.mapSeries=s(p),r.mapLimit=function(n,t,e,r){return y(t)(n,e,r)};var y=function(n){return f(n,p)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var c=i(n,function(n){return n}).reverse();r.reduce(c,t,e,u)},r.foldr=r.reduceRight;var m=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=l(m),r.filterSeries=s(m),r.select=r.filter,r.selectSeries=r.filterSeries;var v=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=l(v),r.rejectSeries=s(v);var h=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(){r()})};r.detect=l(h),r.detectSeries=s(h),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,i(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=o(n);if(!e.length)return t(null);var i={},a=[],l=function(n){a.unshift(n)},f=function(n){for(var t=0;t<a.length;t+=1)if(a[t]===n)return void a.splice(t,1)},s=function(){u(a.slice(0),function(n){n()})};l(function(){o(i).length===e.length&&(t(null,i),t=function(){})}),u(e,function(e){var a=n[e]instanceof Function?[n[e]]:n[e],p=function(n){var c=Array.prototype.slice.call(arguments,1);if(c.length<=1&&(c=c[0]),n){var a={};u(o(i),function(n){a[n]=i[n]}),a[e]=c,t(n,a),t=function(){}}else i[e]=c,r.setImmediate(s)},y=a.slice(0,Math.abs(a.length-1))||[],m=function(){return c(y,function(n,t){return n&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(e)};if(m())a[a.length-1](p,i);else{var v=function(){m()&&(f(v),a[a.length-1](p,i))};l(v)}})},r.waterfall=function(n,t){if(t=t||function(){},n.constructor!==Array){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var u=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),c=n.next();i.push(c?u(c):t),r.setImmediate(function(){n.apply(null,i)})}}};u(r.iterator(n))()};var d=function(n,t,e){if(e=e||function(){},t.constructor===Array)n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(o(t),function(n,e){t[n](function(t){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){d({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){d({map:y(t),each:a(t)},n,e)},r.series=function(n,t){if(t=t||function(){},n.constructor===Array)r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(o(n),function(t,r){n[t](function(n){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var g=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=l(g),r.concatSeries=s(g),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(u){return u?e(u):void(t()?r.doWhilst(n,t,e):e())})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(u){return u?e(u):void(t()?e():r.doUntil(n,t,e))})},r.queue=function(t,e){function i(n,t,i,c){t.constructor!==Array&&(t=[t]),u(t,function(t){var u={data:t,callback:"function"==typeof c?c:null};i?n.tasks.unshift(u):n.tasks.push(u),n.saturated&&n.tasks.length===e&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var c=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(n,t){i(o,n,!1,t)},unshift:function(n,t){i(o,n,!0,t)},process:function(){if(c<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),c+=1;var r=function(){c-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+c===0&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return c}};return o},r.cargo=function(n,t){var e=!1,c=[],o={tasks:c,payload:t,saturated:null,empty:null,drain:null,push:function(n,e){n.constructor!==Array&&(n=[n]),u(n,function(n){c.push({data:n,callback:"function"==typeof e?e:null}),o.saturated&&c.length===t&&o.saturated()}),r.setImmediate(o.process)},process:function a(){if(!e){if(0===c.length)return void(o.drain&&o.drain());var r="number"==typeof t?c.splice(0,t):c.splice(0),l=i(r,function(n){return n.data});o.empty&&o.empty(),e=!0,n(l,function(){e=!1;var n=arguments;u(r,function(t){t.callback&&t.callback.apply(null,n)}),a()})}},length:function(){return c.length},running:function(){return e}};return o};var k=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&u(e,function(t){console[n](t)}))}]))}};r.log=k("log"),r.dir=k("dir"),r.memoize=function(n,t){var e={},r={};t=t||function(n){return n};var u=function(){var u=Array.prototype.slice.call(arguments),i=u.pop(),c=t.apply(null,u);c in e?i.apply(null,e[c]):c in r?r[c].push(i):(r[c]=[i],n.apply(null,u.concat([function(){e[c]=arguments;var n=r[c];delete r[c];for(var t=0,u=n.length;u>t;t++)n[t].apply(null,arguments)}])))};return u.memo=e,u.unmemoized=n,u},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.compose=function(){var n=Array.prototype.reverse.call(arguments);return function(){var t=this,e=Array.prototype.slice.call(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}};var A=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=l(A),r.applyEachSeries=s(A),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof define&&define.amd?define([],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:t.async=r}();
!function(t){if("function"==typeof bootstrap)bootstrap("nedb",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeNedb=t}else"undefined"!=typeof window?window.Nedb=t():global.Nedb=t()}(function(){var t;return function(t,e,n){function r(n,o){if(!e[n]){if(!t[n]){var u="function"==typeof require&&require;if(!o&&u)return u(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var a=e[n]={exports:{}};t[n][0].call(a.exports,function(e){var i=t[n][1][e];return r(i?i:e)},a,a.exports)}return e[n].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}var i=t("__browserify_process");i.EventEmitter||(i.EventEmitter=function(){});var o=n.EventEmitter=i.EventEmitter,u="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=10;o.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},o.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||u(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(u(e)){for(var n=Array.prototype.slice.call(arguments,1),r=e.slice(),i=0,o=r.length;o>i;i++)r[i].apply(this,n);return!0}return!1},o.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(u(this._events[t])){if(!this._events[t].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:a,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},o.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(u(n)){var i=r(n,e);if(0>i)return this;n.splice(i,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},o.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},o.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),u(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:3}],2:[function(t,e,n){function r(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)}function i(t){"object"==typeof t&&"[object RegExp]"===Object.prototype.toString.call(t)}function o(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)}t("events");n.isArray=r,n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},n.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(t,e,s,c){function f(t,s){if(t&&"function"==typeof t.inspect&&t!==n&&(!t.constructor||t.constructor.prototype!==t))return t.inspect(s);switch(typeof t){case"undefined":return h("undefined","undefined");case"string":var c="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return h(c,"string");case"number":return h(""+t,"number");case"boolean":return h(""+t,"boolean")}if(null===t)return h("null","null");var p=u(t),y=e?a(t):p;if("function"==typeof t&&0===y.length){if(i(t))return h(""+t,"regexp");var d=t.name?": "+t.name:"";return h("[Function"+d+"]","special")}if(o(t)&&0===y.length)return h(t.toUTCString(),"date");var g,v,m;if(r(t)?(v="Array",m=["[","]"]):(v="Object",m=["{","}"]),"function"==typeof t){var b=t.name?": "+t.name:"";g=i(t)?" "+t:" [Function"+b+"]"}else g="";if(o(t)&&(g=" "+t.toUTCString()),0===y.length)return m[0]+g+m[1];if(0>s)return i(t)?h(""+t,"regexp"):h("[Object]","special");l.push(t);var w=y.map(function(e){var n,i;if(t.__lookupGetter__&&(t.__lookupGetter__(e)?i=t.__lookupSetter__(e)?h("[Getter/Setter]","special"):h("[Getter]","special"):t.__lookupSetter__(e)&&(i=h("[Setter]","special"))),p.indexOf(e)<0&&(n="["+e+"]"),i||(l.indexOf(t[e])<0?(i=null===s?f(t[e]):f(t[e],s-1),i.indexOf("\n")>-1&&(i=r(t)?i.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+i.split("\n").map(function(t){return"   "+t}).join("\n"))):i=h("[Circular]","special")),"undefined"==typeof n){if("Array"===v&&e.match(/^\d+$/))return i;n=JSON.stringify(""+e),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=h(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=h(n,"string"))}return n+": "+i});l.pop();var k=0,x=w.reduce(function(t,e){return k++,e.indexOf("\n")>=0&&k++,t+e.length+1},0);return w=x>50?m[0]+(""===g?"":g+"\n ")+" "+w.join(",\n  ")+" "+m[1]:m[0]+g+" "+w.join(", ")+" "+m[1]}var l=[],h=function(t,e){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[e];return r?"["+n[r][0]+"m"+t+"["+n[r][1]+"m":t};return c||(h=function(t){return t}),f(t,"undefined"==typeof s?2:s)};n.log=function(){},n.pump=null;var u=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},a=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.hasOwnProperty.call(t,n)&&e.push(n);return e},s=Object.create||function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var r=function(){};r.prototype=t,n=new r,n.__proto__=t}return"undefined"!=typeof e&&Object.defineProperties&&Object.defineProperties(n,e),n};n.inherits=function(t,e){t.super_=e,t.prototype=s(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};var c=/%[sdj%]/g;n.format=function(t){if("string"!=typeof t){for(var e=[],r=0;r<arguments.length;r++)e.push(n.inspect(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,o=i.length,u=String(t).replace(c,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":return JSON.stringify(i[r++]);default:return t}}),a=i[r];o>r;a=i[++r])u+=null===a||"object"!=typeof a?" "+a:" "+n.inspect(a);return u}},{events:1}],3:[function(t,e){var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){if(t.source===window&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var e=n.shift();e()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e){function n(t,e,n){this.db=t,this.query=e||{},n&&(this.execFn=n)}var r=t("./model");n.prototype.limit=function(t){return this._limit=t,this},n.prototype.skip=function(t){return this._skip=t,this},n.prototype.sort=function(t){return this._sort=t,this},n.prototype._exec=function(t){var e,n,i,o=this.db.getCandidates(this.query),u=[],a=0,s=0,c=this;try{for(e=0;e<o.length;e+=1)if(r.match(o[e],this.query))if(this._sort)u.push(o[e]);else if(this._skip&&this._skip>s)s+=1;else if(u.push(o[e]),a+=1,this._limit&&this._limit<=a)break}catch(f){return t(f)}if(this._sort){for(n=Object.keys(this._sort),e=n.length-1;e>=0;e-=1)i=n[e],u.sort(function(t,e){return c._sort[i]*r.compareThings(r.getDotValue(t,i),r.getDotValue(e,i))});var l=this._limit||u.length,h=this._skip||0;u=u.slice(h,h+l)}return this.execFn?this.execFn(null,u,t):t(null,u)},n.prototype.exec=function(){this.db.executor.push({"this":this,fn:this._exec,arguments:arguments})},e.exports=n},{"./model":9}],5:[function(t,e){function n(t){for(var e,e,n=new Array(t),r=0;t>r;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n}function r(t){function e(t){return o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]}var n,r,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=t.length%3,a="";for(i=0,r=t.length-u;r>i;i+=3)n=(t[i]<<16)+(t[i+1]<<8)+t[i+2],a+=e(n);switch(u){case 1:n=t[t.length-1],a+=o[n>>2],a+=o[n<<4&63],a+="==";break;case 2:n=(t[t.length-2]<<8)+t[t.length-1],a+=o[n>>10],a+=o[n>>4&63],a+=o[n<<2&63],a+="="}return a}function i(t){return r(n(Math.ceil(Math.max(8,2*t)))).replace(/[+\/]/g,"").slice(0,t)}e.exports.uid=i},{}],6:[function(t,e){function n(t){var e;"string"==typeof t?(e=t,this.inMemoryOnly=!1):(t=t||{},e=t.filename,this.inMemoryOnly=t.inMemoryOnly||!1,this.autoload=t.autoload||!1),e&&"string"==typeof e&&0!==e.length?this.filename=e:(this.filename=null,this.inMemoryOnly=!0),this.persistence=new f({db:this,nodeWebkitAppName:t.nodeWebkitAppName}),this.executor=new u,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new a({fieldName:"_id",unique:!0}),this.autoload&&this.loadDatabase(t.onload||function(t){if(t)throw t})}var r=t("./customUtils"),i=t("./model"),o=t("async"),u=t("./executor"),a=t("./indexes"),s=t("util"),c=t("underscore"),f=t("./persistence"),l=t("./cursor");n.prototype.loadDatabase=function(){this.executor.push({"this":this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)},n.prototype.getAllData=function(){return this.indexes._id.getAll()},n.prototype.resetIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].reset(t)})},n.prototype.ensureIndex=function(t,e){var n=e||function(){};if(t=t||{},!t.fieldName)return n({missingFieldName:!0});if(this.indexes[t.fieldName])return n(null);this.indexes[t.fieldName]=new a(t);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(r){return delete this.indexes[t.fieldName],n(r)}this.persistence.persistNewState([{$$indexCreated:t}],function(t){return n(t?t:null)})},n.prototype.removeIndex=function(t,e){var n=e||function(){};delete this.indexes[t],this.persistence.persistNewState([{$$indexRemoved:t}],function(t){return n(t?t:null)})},n.prototype.addToIndexes=function(t){var e,n,r,i=Object.keys(this.indexes);for(e=0;e<i.length;e+=1)try{this.indexes[i[e]].insert(t)}catch(o){n=e,r=o;break}if(r){for(e=0;n>e;e+=1)this.indexes[i[e]].remove(t);throw r}},n.prototype.removeFromIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].remove(t)})},n.prototype.updateIndexes=function(t,e){var n,r,i,o=Object.keys(this.indexes);for(n=0;n<o.length;n+=1)try{this.indexes[o[n]].update(t,e)}catch(u){r=n,i=u;break}if(i){for(n=0;r>n;n+=1)this.indexes[o[n]].revertUpdate(t,e);throw i}},n.prototype.getCandidates=function(t){var e,n=Object.keys(this.indexes);return e=[],Object.keys(t).forEach(function(n){("string"==typeof t[n]||"number"==typeof t[n]||"boolean"==typeof t[n]||s.isDate(t[n])||null===t[n])&&e.push(n)}),e=c.intersection(e,n),e.length>0?this.indexes[e[0]].getMatching(t[e[0]]):(e=[],Object.keys(t).forEach(function(n){t[n]&&t[n].hasOwnProperty("$in")&&e.push(n)}),e=c.intersection(e,n),e.length>0?this.indexes[e[0]].getMatching(t[e[0]].$in):(e=[],Object.keys(t).forEach(function(n){t[n]&&(t[n].hasOwnProperty("$lt")||t[n].hasOwnProperty("$lte")||t[n].hasOwnProperty("$gt")||t[n].hasOwnProperty("$gte"))&&e.push(n)}),e=c.intersection(e,n),e.length>0?this.indexes[e[0]].getBetweenBounds(t[e[0]]):this.getAllData()))},n.prototype._insert=function(t,e){var n=e||function(){};try{this._insertInCache(t)}catch(r){return n(r)}this.persistence.persistNewState(s.isArray(t)?t:[t],function(e){return e?n(e):n(null,t)})},n.prototype.prepareDocumentForInsertion=function(t){var e,n=this;return s.isArray(t)?(e=[],t.forEach(function(t){e.push(n.prepareDocumentForInsertion(t))})):(t._id=r.uid(16),e=i.deepCopy(t),i.checkObject(e)),e},n.prototype._insertInCache=function(t){s.isArray(t)?this._insertMultipleDocsInCache(t):this.addToIndexes(this.prepareDocumentForInsertion(t))},n.prototype._insertMultipleDocsInCache=function(t){var e,n,r,i=this.prepareDocumentForInsertion(t);for(e=0;e<i.length;e+=1)try{this.addToIndexes(i[e])}catch(o){r=o,n=e;break}if(r){for(e=0;n>e;e+=1)this.removeFromIndexes(i[e]);throw r}},n.prototype.insert=function(){this.executor.push({"this":this,fn:this._insert,arguments:arguments})},n.prototype.count=function(t,e){var n=new l(this,t,function(t,e,n){return t?n(t):n(null,e.length)});return"function"!=typeof e?n:void n.exec(e)},n.prototype.find=function(t,e){var n=new l(this,t,function(t,e,n){var r,o=[];if(t)return n(t);for(r=0;r<e.length;r+=1)o.push(i.deepCopy(e[r]));return n(null,o)});return"function"!=typeof e?n:void n.exec(e)},n.prototype.findOne=function(t,e){var n=new l(this,t,function(t,e,n){return t?n(t):1===e.length?n(null,i.deepCopy(e[0])):n(null,null)});return n.limit(1),"function"!=typeof e?n:void n.exec(e)},n.prototype._update=function(t,e,n,r){var u,a,s,f,h=this,p=0;"function"==typeof n&&(r=n,n={}),u=r||function(){},a=void 0!==n.multi?n.multi:!1,s=void 0!==n.upsert?n.upsert:!1,o.waterfall([function(n){if(!s)return n();var r=new l(h,t);r.limit(1)._exec(function(r,o){return r?u(r):1===o.length?n():h._insert(i.modify(t,e),function(t,e){return t?u(t):u(null,1,e)})})},function(){var n,r=h.getCandidates(t),o=[];try{for(f=0;f<r.length;f+=1)i.match(r[f],t)&&(a||0===p)&&(p+=1,n=i.modify(r[f],e),o.push({oldDoc:r[f],newDoc:n}))}catch(s){return u(s)}try{h.updateIndexes(o)}catch(s){return u(s)}h.persistence.persistNewState(c.pluck(o,"newDoc"),function(t){return t?u(t):u(null,p)})}])},n.prototype.update=function(){this.executor.push({"this":this,fn:this._update,arguments:arguments})},n.prototype._remove=function(t,e,n){var r,o,u=this,a=0,s=[],c=this.getCandidates(t);"function"==typeof e&&(n=e,e={}),r=n||function(){},o=void 0!==e.multi?e.multi:!1;try{c.forEach(function(e){i.match(e,t)&&(o||0===a)&&(a+=1,s.push({$$deleted:!0,_id:e._id}),u.removeFromIndexes(e))})}catch(f){return r(f)}u.persistence.persistNewState(s,function(t){return t?r(t):r(null,a)})},n.prototype.remove=function(){this.executor.push({"this":this,fn:this._remove,arguments:arguments})},e.exports=n},{"./cursor":4,"./customUtils":5,"./executor":7,"./indexes":8,"./model":9,"./persistence":10,async:11,underscore:16,util:2}],7:[function(t,e){function n(){this.buffer=[],this.ready=!1,this.queue=i.queue(function(t,e){var n,i,o=t.arguments[t.arguments.length-1],u=[];for(i=0;i<t.arguments.length;i+=1)u.push(t.arguments[i]);"function"==typeof o?(n=function(){r.nextTick(e),o.apply(null,arguments)},u[u.length-1]=n):(n=function(){e()},u.push(n)),t.fn.apply(t.this,u)},1)}var r=t("__browserify_process"),i=t("async");n.prototype.push=function(t,e){this.ready||e?this.queue.push(t):this.buffer.push(t)},n.prototype.processBuffer=function(){var t;for(this.ready=!0,t=0;t<this.buffer.length;t+=1)this.queue.push(this.buffer[t]);this.buffer=[]},e.exports=n},{__browserify_process:3,async:11}],8:[function(t,e){function n(t,e){return t===e}function r(t){return null===t?"$null":"string"==typeof t?"$string"+t:"boolean"==typeof t?"$boolean"+t:"number"==typeof t?"$number"+t:c.isArray(t)?"$date"+t.getTime():t}function i(t){this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:a.compareThings,checkValueEquality:n},this.reset()}function o(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}var u=t("binary-search-tree").AVLTree,a=t("./model"),s=t("underscore"),c=t("util");i.prototype.reset=function(t){this.tree=new u(this.treeOptions),t&&this.insert(t)},i.prototype.insert=function(t){var e,n,i,o,u;if(c.isArray(t))return void this.insertMultipleDocs(t);if(e=a.getDotValue(t,this.fieldName),void 0!==e||!this.sparse)if(c.isArray(e)){for(n=s.uniq(e,r),i=0;i<n.length;i+=1)try{this.tree.insert(n[i],t)}catch(f){u=f,o=i;break}if(u){for(i=0;o>i;i+=1)this.tree.delete(n[i],t);throw u}}else this.tree.insert(e,t)},i.prototype.insertMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.insert(t[e])}catch(i){n=i,r=e;break}if(n){for(e=0;r>e;e+=1)this.remove(t[e]);throw n}},i.prototype.remove=function(t){var e,n=this;return c.isArray(t)?void t.forEach(function(t){n.remove(t)}):(e=a.getDotValue(t,this.fieldName),void(void 0===e&&this.sparse||(c.isArray(e)?s.uniq(e,r).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))))},i.prototype.update=function(t,e){if(c.isArray(t))return void this.updateMultipleDocs(t);this.remove(t);try{this.insert(e)}catch(n){throw this.insert(t),n}},i.prototype.updateMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)this.remove(t[e].oldDoc);for(e=0;e<t.length;e+=1)try{this.insert(t[e].newDoc)}catch(i){r=i,n=e;break}if(r){for(e=0;n>e;e+=1)this.remove(t[e].newDoc);for(e=0;e<t.length;e+=1)this.insert(t[e].oldDoc);throw r}},i.prototype.revertUpdate=function(t,e){var n=[];c.isArray(t)?(t.forEach(function(t){n.push({oldDoc:t.newDoc,newDoc:t.oldDoc})}),this.update(n)):this.update(e,t)},i.prototype.getMatching=function(t){var e,n=this;return c.isArray(t)?(e=[],t.forEach(function(t){o(e,n.getMatching(t))}),e):this.tree.search(t)},i.prototype.getBetweenBounds=function(t){return this.tree.betweenBounds(t)},i.prototype.getAll=function(){var t=[];return this.tree.executeOnEveryNode(function(e){var n;for(n=0;n<e.data.length;n+=1)t.push(e.data[n])}),t},e.exports=i},{"./model":9,"binary-search-tree":12,underscore:16,util:2}],9:[function(t,e){function n(t,e){if(!("$"!==t[0]||"$$date"===t&&"number"==typeof e||"$$deleted"===t&&e===!0||"$$indexCreated"===t||"$$indexRemoved"===t))throw"Field names cannot begin with the $ character";if(-1!==t.indexOf("."))throw"Field names cannot contain a ."}function r(t){w.isArray(t)&&t.forEach(function(t){r(t)}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){n(e,t[e]),r(t[e])})}function i(t){var e;return Date.prototype.toJSON=m,e=JSON.stringify(t,function(t,e){return n(t,e),void 0===typeof e?null:"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e}),Date.prototype.toJSON=b,e}function o(t){return JSON.parse(t,function(t,e){return"$$date"===t?new Date(e):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e&&e.$$date?e.$$date:e})}function u(t){var e;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||w.isDate(t)?t:w.isArray(t)?(e=[],t.forEach(function(t){e.push(t)}),e):"object"==typeof t?(e={},Object.keys(t).forEach(function(n){e[n]=u(t[n])}),e):void 0}function a(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||w.isDate(t)||w.isArray(t)}function s(t,e){return e>t?-1:t>e?1:0}function c(t,e){var n,r;for(n=0;n<Math.min(t.length,e.length);n+=1)if(r=f(t[n],e[n]),0!==r)return r;return s(t.length,e.length)}function f(t,e){var n,r,i,o;if(void 0===t)return void 0===e?0:-1;if(void 0===e)return void 0===t?0:1;if(null===t)return null===e?0:-1;if(null===e)return null===t?0:1;if("number"==typeof t)return"number"==typeof e?s(t,e):-1;if("number"==typeof e)return"number"==typeof t?s(t,e):1;if("string"==typeof t)return"string"==typeof e?s(t,e):-1;if("string"==typeof e)return"string"==typeof t?s(t,e):1;if("boolean"==typeof t)return"boolean"==typeof e?s(t,e):-1;if("boolean"==typeof e)return"boolean"==typeof t?s(t,e):1;if(w.isDate(t))return w.isDate(e)?s(t.getTime(),e.getTime()):-1;if(w.isDate(e))return w.isDate(t)?s(t.getTime(),e.getTime()):1;if(w.isArray(t))return w.isArray(e)?c(t,e):-1;if(w.isArray(e))return w.isArray(t)?c(t,e):1;for(n=Object.keys(t).sort(),r=Object.keys(e).sort(),o=0;o<Math.min(n.length,r.length);o+=1)if(i=f(t[n[o]],e[r[o]]),0!==i)return i;return s(n.length,r.length)}function l(t){return function(e,n,r){var i="string"==typeof n?n.split("."):n;1===i.length?_[t](e,n,r):(e[i[0]]=e[i[0]]||{},x[t](e[i[0]],i.slice(1),r))}}function h(t,e){var n,i,o=Object.keys(e),a=k.map(o,function(t){return t[0]}),s=k.filter(a,function(t){return"$"===t});if(-1!==o.indexOf("_id")&&e._id!==t._id)throw"You cannot change a document's _id";if(0!==s.length&&s.length!==a.length)throw"You cannot mix modifiers and normal fields";if(0===s.length?(n=u(e),n._id=t._id):(i=k.uniq(o),n=u(t),i.forEach(function(t){var r;if(!x[t])throw"Unknown modifier "+t;try{r=Object.keys(e[t])}catch(i){throw"Modifier "+t+"'s argument must be an object"}r.forEach(function(r){x[t](n,r,e[t][r])})})),r(n),t._id!==n._id)throw"You can't change a document's _id";return n}function p(t,e){var n,r,i="string"==typeof e?e.split("."):e;if(!t)return void 0;if(0===i.length)return t;if(1===i.length)return t[i[0]];if(w.isArray(t[i[0]])){if(n=parseInt(i[1],10),"number"==typeof n&&!isNaN(n))return p(t[i[0]][n],i.slice(2));for(r=new Array,n=0;n<t[i[0]].length;n+=1)r.push(p(t[i[0]][n],i.slice(1)));return r}return p(t[i[0]],i.slice(1))}function y(t,e){var n,r,i;if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return t===e;if(w.isDate(t)||w.isDate(e))return w.isDate(t)&&w.isDate(e)&&t.getTime()===e.getTime();if(w.isArray(t)||w.isArray(e)||void 0===t||void 0===e)return!1;try{n=Object.keys(t),r=Object.keys(e)}catch(o){return!1}if(n.length!==r.length)return!1;for(i=0;i<n.length;i+=1){if(-1===r.indexOf(n[i]))return!1;if(!y(t[n[i]],e[n[i]]))return!1}return!0}function d(t,e){return"string"==typeof t||"number"==typeof t||w.isDate(t)||"string"==typeof e||"number"==typeof e||w.isDate(e)?typeof t!=typeof e?!1:!0:!1}function g(t,e){var n,r,i,o;if(a(t)||a(e))return v({needAKey:t},"needAKey",e);for(n=Object.keys(e),o=0;o<n.length;o+=1)if(r=n[o],i=e[r],"$"===r[0]){if(!A[r])throw"Unknown logical operator "+r;if(!A[r](t,i))return!1}else if(!v(t,r,i))return!1;return!0}function v(t,e,n,r){var i,o,u,a,s=p(t,e);if(w.isArray(s)&&!r){if(null!==n&&"object"==typeof n&&!w.isRegExp(n))for(o=Object.keys(n),i=0;i<o.length;i+=1)if($[o[i]])return v(t,e,n,!0);for(i=0;i<s.length;i+=1)if(v({k:s[i]},"k",n))return!0;return!1}if(null!==n&&"object"==typeof n&&!w.isRegExp(n)){if(o=Object.keys(n),u=k.map(o,function(t){return t[0]}),a=k.filter(u,function(t){return"$"===t}),0!==a.length&&a.length!==u.length)throw"You cannot mix operators and normal fields";if(a.length>0){for(i=0;i<o.length;i+=1){if(!O[o[i]])throw"Unknown comparison function "+o[i];if(!O[o[i]](s,n[o[i]]))return!1}return!0}}return w.isRegExp(n)?O.$regex(s,n):y(s,n)?!0:!1}var m=function(){return{$$date:this.getTime()}},b=Date.prototype.toJSON,w=t("util"),k=t("underscore"),x={},_={},O={},A={},$={};_.$set=function(t,e,n){t[e]=n},_.$unset=function(t,e){delete t[e]},_.$push=function(t,e,n){if(t.hasOwnProperty(e)||(t[e]=[]),!w.isArray(t[e]))throw"Can't $push an element on non-array values";if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw"Can't use another field in conjunction with $each";if(!w.isArray(n.$each))throw"$each requires an array value";n.$each.forEach(function(n){t[e].push(n)})}else t[e].push(n)},_.$addToSet=function(t,e,n){var r=!0;if(t.hasOwnProperty(e)||(t[e]=[]),!w.isArray(t[e]))throw"Can't $addToSet an element on non-array values";if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw"Can't use another field in conjunction with $each";if(!w.isArray(n.$each))throw"$each requires an array value";n.$each.forEach(function(n){_.$addToSet(t,e,n)})}else t[e].forEach(function(t){0===f(t,n)&&(r=!1)}),r&&t[e].push(n)},_.$pop=function(t,e,n){if(!w.isArray(t[e]))throw"Can't $pop an element from non-array values";if("number"!=typeof n)throw n+" isn't an integer, can't use it with $pop";0!==n&&(t[e]=n>0?t[e].slice(0,t[e].length-1):t[e].slice(1))},_.$pull=function(t,e,n){var r,i;if(!w.isArray(t[e]))throw"Can't $pull an element from non-array values";for(r=t[e],i=r.length-1;i>=0;i-=1)g(r[i],n)&&r.splice(i,1)},_.$inc=function(t,e,n){if("number"!=typeof n)throw n+" must be a number";if("number"!=typeof t[e]){if(k.has(t,e))throw"Don't use the $inc modifier on non-number fields";t[e]=n}else t[e]+=n},Object.keys(_).forEach(function(t){x[t]=l(t)}),O.$lt=function(t,e){return d(t,e)&&e>t},O.$lte=function(t,e){return d(t,e)&&e>=t},O.$gt=function(t,e){return d(t,e)&&t>e},O.$gte=function(t,e){return d(t,e)&&t>=e},O.$ne=function(t,e){return t?!y(t,e):!0},O.$in=function(t,e){var n;if(!w.isArray(e))throw"$in operator called with a non-array";for(n=0;n<e.length;n+=1)if(y(t,e[n]))return!0;return!1},O.$nin=function(t,e){if(!w.isArray(e))throw"$nin operator called with a non-array";return!O.$in(t,e)},O.$regex=function(t,e){if(!w.isRegExp(e))throw"$regex operator called with non regular expression";return"string"!=typeof t?!1:e.test(t)},O.$exists=function(t,e){return e=e||""===e?!0:!1,void 0===t?!e:e},O.$size=function(t,e){if(!w.isArray(t))return!1;if(e%1!==0)throw"$size operator called without an integer";return t.length==e},$.$size=!0,A.$or=function(t,e){var n;if(!w.isArray(e))throw"$or operator used without an array";for(n=0;n<e.length;n+=1)if(g(t,e[n]))return!0;return!1},A.$and=function(t,e){var n;if(!w.isArray(e))throw"$and operator used without an array";for(n=0;n<e.length;n+=1)if(!g(t,e[n]))return!1;return!0},A.$not=function(t,e){return!g(t,e)},A.$where=function(t,e){var n;if(!k.isFunction(e))throw"$where operator used without a function";if(n=e.call(t),!k.isBoolean(n))throw"$where function must return boolean";return n},e.exports.serialize=i,e.exports.deserialize=o,e.exports.deepCopy=u,e.exports.checkObject=r,e.exports.isPrimitiveType=a,e.exports.modify=h,e.exports.getDotValue=p,e.exports.match=g,e.exports.areThingsEqual=y,e.exports.compareThings=f},{underscore:16,util:2}],10:[function(t,e){function n(t){this.db=t.db,this.db.inMemoryOnly=!0,this.db.filename=null,this.inMemoryOnly=!0}n.prototype.persistNewState=function(t,e){return e?e():void 0},n.prototype.loadDatabase=function(t){return t?t():void 0},e.exports=n},{}],11:[function(e,n){var r=e("__browserify_process");!function(){function e(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(i,arguments)}}var i,o,u={};i=this,null!=i&&(o=i.async),u.noConflict=function(){return i.async=o,u};var a=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},s=function(t,e){if(t.map)return t.map(e);var n=[];return a(t,function(t,r,i){n.push(e(t,r,i))}),n},c=function(t,e,n){return t.reduce?t.reduce(e,n):(a(t,function(t,r,i){n=e(n,t,r,i)}),n)},f=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};"undefined"!=typeof r&&r.nextTick?(u.nextTick=r.nextTick,u.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:u.nextTick):"function"==typeof setImmediate?(u.nextTick=function(t){setImmediate(t)},u.setImmediate=u.nextTick):(u.nextTick=function(t){setTimeout(t,0)},u.setImmediate=u.nextTick),u.each=function(t,n,r){if(r=r||function(){},!t.length)return r();var i=0;a(t,function(o){n(o,e(function(e){e?(r(e),r=function(){}):(i+=1,i>=t.length&&r(null))}))})},u.forEach=u.each,u.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0,i=function(){e(t[r],function(e){e?(n(e),n=function(){}):(r+=1,r>=t.length?n(null):i())})};i()},u.forEachSeries=u.eachSeries,u.eachLimit=function(t,e,n,r){var i=l(e);i.apply(null,[t,n,r])},u.forEachLimit=u.eachLimit;var l=function(t){return function(e,n,r){if(r=r||function(){},!e.length||0>=t)return r();var i=0,o=0,u=0;!function a(){if(i>=e.length)return r();for(;t>u&&o<e.length;)o+=1,u+=1,n(e[o-1],function(t){t?(r(t),r=function(){}):(i+=1,u-=1,i>=e.length?r():a())})}()}},h=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[u.each].concat(e))}},p=function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[l(t)].concat(n))}},y=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[u.eachSeries].concat(e))}},d=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n,r){i[t.index]=r,e(n)})},function(t){r(t,i)})};u.map=h(d),u.mapSeries=y(d),u.mapLimit=function(t,e,n,r){return g(e)(t,n,r)};var g=function(t){return p(t,d)};u.reduce=function(t,e,n,r){u.eachSeries(t,function(t,r){n(e,t,function(t,n){e=n,r(t)})},function(t){r(t,e)})},u.inject=u.reduce,u.foldl=u.reduce,u.reduceRight=function(t,e,n,r){var i=s(t,function(t){return t}).reverse();u.reduce(i,e,n,r)},u.foldr=u.reduceRight;var v=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n&&i.push(t),e()})},function(){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};u.filter=h(v),u.filterSeries=y(v),u.select=u.filter,u.selectSeries=u.filterSeries;var m=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n||i.push(t),e()})},function(){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};u.reject=h(m),u.rejectSeries=y(m);var b=function(t,e,n,r){t(e,function(t,e){n(t,function(n){n?(r(t),r=function(){}):e()})},function(){r()})};u.detect=h(b),u.detectSeries=y(b),u.some=function(t,e,n){u.each(t,function(t,r){e(t,function(t){t&&(n(!0),n=function(){}),r()})},function(){n(!1)})},u.any=u.some,u.every=function(t,e,n){u.each(t,function(t,r){e(t,function(t){t||(n(!1),n=function(){}),r()})},function(){n(!0)})},u.all=u.every,u.sortBy=function(t,e,n){u.map(t,function(t,n){e(t,function(e,r){e?n(e):n(null,{value:t,criteria:r})})},function(t,e){if(t)return n(t);var r=function(t,e){var n=t.criteria,r=e.criteria;return r>n?-1:n>r?1:0};n(null,s(e.sort(r),function(t){return t.value}))})},u.auto=function(t,e){e=e||function(){};var n=f(t);if(!n.length)return e(null);var r={},i=[],o=function(t){i.unshift(t)},s=function(t){for(var e=0;e<i.length;e+=1)if(i[e]===t)return void i.splice(e,1)},l=function(){a(i.slice(0),function(t){t()})};o(function(){f(r).length===n.length&&(e(null,r),e=function(){})}),a(n,function(n){var i=t[n]instanceof Function?[t[n]]:t[n],h=function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),t){var o={};a(f(r),function(t){o[t]=r[t]}),o[n]=i,e(t,o),e=function(){}}else r[n]=i,u.setImmediate(l)},p=i.slice(0,Math.abs(i.length-1))||[],y=function(){return c(p,function(t,e){return t&&r.hasOwnProperty(e)},!0)&&!r.hasOwnProperty(n)};if(y())i[i.length-1](h,r);else{var d=function(){y()&&(s(d),i[i.length-1](h,r))};o(d)}})},u.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");
return e(n)}if(!t.length)return e();var r=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=t.next();i.push(o?r(o):e),u.setImmediate(function(){t.apply(null,i)})}}};r(u.iterator(t))()};var w=function(t,e,n){if(n=n||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var r={};t.each(f(e),function(t,n){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[t]=i,n(e)})},function(t){n(t,r)})}};u.parallel=function(t,e){w({map:u.map,each:u.each},t,e)},u.parallelLimit=function(t,e,n){w({map:g(e),each:l(e)},t,n)},u.series=function(t,e){if(e=e||function(){},t.constructor===Array)u.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};u.eachSeries(f(t),function(e,r){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[e]=i,r(t)})},function(t){e(t,n)})}},u.iterator=function(t){var e=function(n){var r=function(){return t.length&&t[n].apply(null,arguments),r.next()};return r.next=function(){return n<t.length-1?e(n+1):null},r};return e(0)},u.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var k=function(t,e,n,r){var i=[];t(e,function(t,e){n(t,function(t,n){i=i.concat(n||[]),e(t)})},function(t){r(t,i)})};u.concat=h(k),u.concatSeries=y(k),u.whilst=function(t,e,n){t()?e(function(r){return r?n(r):void u.whilst(t,e,n)}):n()},u.doWhilst=function(t,e,n){t(function(r){return r?n(r):void(e()?u.doWhilst(t,e,n):n())})},u.until=function(t,e,n){t()?n():e(function(r){return r?n(r):void u.until(t,e,n)})},u.doUntil=function(t,e,n){t(function(r){return r?n(r):void(e()?n():u.doUntil(t,e,n))})},u.queue=function(t,n){function r(t,e,r,i){e.constructor!==Array&&(e=[e]),a(e,function(e){var o={data:e,callback:"function"==typeof i?i:null};r?t.tasks.unshift(o):t.tasks.push(o),t.saturated&&t.tasks.length===n&&t.saturated(),u.setImmediate(t.process)})}void 0===n&&(n=1);var i=0,o={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(t,e){r(o,t,!1,e)},unshift:function(t,e){r(o,t,!0,e)},process:function(){if(i<o.concurrency&&o.tasks.length){var n=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),i+=1;var r=function(){i-=1,n.callback&&n.callback.apply(n,arguments),o.drain&&o.tasks.length+i===0&&o.drain(),o.process()},u=e(r);t(n.data,u)}},length:function(){return o.tasks.length},running:function(){return i}};return o},u.cargo=function(t,e){var n=!1,r=[],i={tasks:r,payload:e,saturated:null,empty:null,drain:null,push:function(t,n){t.constructor!==Array&&(t=[t]),a(t,function(t){r.push({data:t,callback:"function"==typeof n?n:null}),i.saturated&&r.length===e&&i.saturated()}),u.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return void(i.drain&&i.drain());var u="number"==typeof e?r.splice(0,e):r.splice(0),c=s(u,function(t){return t.data});i.empty&&i.empty(),n=!0,t(c,function(){n=!1;var t=arguments;a(u,function(e){e.callback&&e.callback.apply(null,t)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var x=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&a(n,function(e){console[t](e)}))}]))}};u.log=x("log"),u.dir=x("dir"),u.memoize=function(t,e){var n={},r={};e=e||function(t){return t};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),u=e.apply(null,i);u in n?o.apply(null,n[u]):u in r?r[u].push(o):(r[u]=[o],t.apply(null,i.concat([function(){n[u]=arguments;var t=r[u];delete r[u];for(var e=0,i=t.length;i>e;e++)t[e].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=t,i},u.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},u.times=function(t,e,n){for(var r=[],i=0;t>i;i++)r.push(i);return u.map(r,e,n)},u.timesSeries=function(t,e,n){for(var r=[],i=0;t>i;i++)r.push(i);return u.mapSeries(r,e,n)},u.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();u.reduce(t,n,function(t,n,r){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);r(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}};var _=function(t,e){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return t(e,function(t,e){t.apply(n,r.concat([e]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};u.applyEach=h(_),u.applyEachSeries=y(_),u.forever=function(t,e){function n(r){if(r){if(e)return e(r);throw r}t(n)}n()},"undefined"!=typeof t&&t.amd?t([],function(){return u}):"undefined"!=typeof n&&n.exports?n.exports=u:i.async=u}()},{__browserify_process:3}],12:[function(t,e){e.exports.BinarySearchTree=t("./lib/bst"),e.exports.AVLTree=t("./lib/avltree")},{"./lib/avltree":13,"./lib/bst":14}],13:[function(t,e){function n(t){this.tree=new r(t)}function r(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||o.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||o.defaultCheckValueEquality}{var i=t("./bst"),o=t("./customUtils"),u=t("util");t("underscore")}u.inherits(r,i),n._AVLTree=r,r.prototype.checkHeightCorrect=function(){var t,e;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw"Undefined height for node "+this.left.key;if(this.right&&void 0===this.right.height)throw"Undefined height for node "+this.right.key;if(void 0===this.height)throw"Undefined height for node "+this.key;if(t=this.left?this.left.height:0,e=this.right?this.right.height:0,this.height!==1+Math.max(t,e))throw"Height constraint failed for node "+this.key;this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},r.prototype.balanceFactor=function(){var t=this.left?this.left.height:0,e=this.right?this.right.height:0;return t-e},r.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw"Tree is unbalanced at node "+this.key;this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},r.prototype.checkIsAVLT=function(){r.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},n.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},r.prototype.rightRotation=function(){var t,e,n,r,i=this,o=this.left;return o?(t=o.right,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.right=i,i.parent=o,i.left=t,t&&(t.parent=i),e=o.left?o.left.height:0,n=t?t.height:0,r=i.right?i.right.height:0,i.height=Math.max(n,r)+1,o.height=Math.max(e,i.height)+1,o):this},r.prototype.leftRotation=function(){var t,e,n,r,i=this,o=this.right;return o?(t=o.left,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.left=i,i.parent=o,i.right=t,t&&(t.parent=i),e=i.left?i.left.height:0,n=t?t.height:0,r=o.right?o.right.height:0,i.height=Math.max(e,n)+1,o.height=Math.max(r,i.height)+1,o):this},r.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},r.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},r.prototype.rebalanceAlongPath=function(t){var e,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=t.length-1;n>=0;n-=1)t[n].height=1+Math.max(t[n].left?t[n].left.height:0,t[n].right?t[n].right.height:0),t[n].balanceFactor()>1&&(e=t[n].rightTooSmall(),0===n&&(r=e)),t[n].balanceFactor()<-1&&(e=t[n].leftTooSmall(),0===n&&(r=e));return r},r.prototype.insert=function(t,e){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.data.push(e),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique)throw{message:"Can't insert key "+t+", it violates the unique constraint",key:t,errorType:"uniqueViolated"};return r.data.push(e),this}if(n.push(r),r.compareKeys(t,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:t,value:e}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:t,value:e}));break}r=r.right}}return this.rebalanceAlongPath(n)},n.prototype.insert=function(t,e){var n=this.tree.insert(t,e);n&&(this.tree=n)},r.prototype.delete=function(t,e){var n,r=[],i=this,o=[];if(!this.hasOwnProperty("key"))return this;for(;;){if(0===i.compareKeys(t,i.key))break;if(o.push(i),i.compareKeys(t,i.key)<0){if(!i.left)return this;i=i.left}else{if(!i.right)return this;i=i.right}}if(i.data.length>1&&e)return i.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),i.data=r,this;if(!i.left&&!i.right)return i===this?(delete i.key,i.data=[],delete i.height,this):(i.parent.left===i?i.parent.left=null:i.parent.right=null,this.rebalanceAlongPath(o));if(!i.left||!i.right)return n=i.left?i.left:i.right,i===this?(n.parent=null,n):(i.parent.left===i?(i.parent.left=n,n.parent=i.parent):(i.parent.right=n,n.parent=i.parent),this.rebalanceAlongPath(o));if(o.push(i),n=i.left,!n.right)return i.key=n.key,i.data=n.data,i.left=n.left,n.left&&(n.left.parent=i),this.rebalanceAlongPath(o);for(;;){if(!n.right)break;o.push(n),n=n.right}return i.key=n.key,i.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(o)},n.prototype.delete=function(t,e){var n=this.tree.delete(t,e);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(t){n.prototype[t]=function(){return this.tree[t].apply(this.tree,arguments)}}),e.exports=n},{"./bst":14,"./customUtils":15,underscore:16,util:2}],14:[function(t,e){function n(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||i.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||i.defaultCheckValueEquality}function r(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}var i=t("./customUtils");n.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},n.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},n.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},n.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},n.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},n.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)>=0)throw"Tree with root "+t.key+" is not a binary search tree"}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw"Tree with root "+t.key+" is not a binary search tree"}),this.right.checkNodeOrdering()))},n.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw"Parent pointer broken for key "+this.key;this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw"Parent pointer broken for key "+this.key;this.right.checkInternalPointers()}},n.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw"The root shouldn't have a parent"},n.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},n.prototype.createSimilar=function(t){return t=t||{},t.unique=this.unique,t.compareKeys=this.compareKeys,t.checkValueEquality=this.checkValueEquality,new this.constructor(t)},n.prototype.createLeftChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.left=e,e},n.prototype.createRightChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.right=e,e},n.prototype.insert=function(t,e){if(!this.hasOwnProperty("key"))return this.key=t,void this.data.push(e);if(0===this.compareKeys(this.key,t)){if(this.unique)throw{message:"Can't insert key "+t+", it violates the unique constraint",key:t,errorType:"uniqueViolated"};return void this.data.push(e)}this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,e):this.createLeftChild({key:t,value:e}):this.right?this.right.insert(t,e):this.createRightChild({key:t,value:e})},n.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.data:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},n.prototype.getLowerBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===e.compareKeys(t.$gte,t.$gt)?function(n){return e.compareKeys(n,t.$gt)>0}:e.compareKeys(t.$gte,t.$gt)>0?function(n){return e.compareKeys(n,t.$gte)>=0}:function(n){return e.compareKeys(n,t.$gt)>0}:t.hasOwnProperty("$gt")?function(n){return e.compareKeys(n,t.$gt)>0}:function(n){return e.compareKeys(n,t.$gte)>=0}:function(){return!0}},n.prototype.getUpperBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===e.compareKeys(t.$lte,t.$lt)?function(n){return e.compareKeys(n,t.$lt)<0}:e.compareKeys(t.$lte,t.$lt)<0?function(n){return e.compareKeys(n,t.$lte)<=0}:function(n){return e.compareKeys(n,t.$lt)<0}:t.hasOwnProperty("$lt")?function(n){return e.compareKeys(n,t.$lt)<0}:function(n){return e.compareKeys(n,t.$lte)<=0}:function(){return!0}},n.prototype.betweenBounds=function(t,e,n){var i=[];return this.hasOwnProperty("key")?(e=e||this.getLowerBoundMatcher(t),n=n||this.getUpperBoundMatcher(t),e(this.key)&&this.left&&r(i,this.left.betweenBounds(t,e,n)),e(this.key)&&n(this.key)&&r(i,this.data),n(this.key)&&this.right&&r(i,this.right.betweenBounds(t,e,n)),i):[]},n.prototype.deleteIfLeaf=function(){return this.left||this.right?!1:this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0)},n.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),t?this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.data=t.data,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0):!1},n.prototype.delete=function(t,e){var n,r=[],i=this;if(this.hasOwnProperty("key")){if(this.compareKeys(t,this.key)<0)return void(this.left&&this.left.delete(t,e));if(this.compareKeys(t,this.key)>0)return void(this.right&&this.right.delete(t,e));if(0!==!this.compareKeys(t,this.key))return this.data.length>1&&e?(this.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),void(i.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))}},n.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},n.prototype.prettyPrint=function(t,e){e=e||"",console.log(e+"* "+this.key),t&&console.log(e+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,e+"  "):console.log(e+"  *"),this.right?this.right.prettyPrint(t,e+"  "):console.log(e+"  *"))},e.exports=n},{"./customUtils":15}],15:[function(t,e){function n(t){var e,r;return 0===t?[]:1===t?[0]:(e=n(t-1),r=Math.floor(Math.random()*t),e.splice(r,0,t-1),e)}function r(t,e){if(e>t)return-1;if(t>e)return 1;if(t===e)return 0;throw{message:"Couldn't compare elements",a:t,b:e}}function i(t,e){return t===e}e.exports.getRandomArray=n,e.exports.defaultCompareKeysFunction=r,e.exports.defaultCheckValueEquality=i},{}],16:[function(t,e,n){(function(){var t=this,r=t._,i={},o=Array.prototype,u=Object.prototype,a=Function.prototype,s=o.push,c=o.slice,f=o.concat,l=u.toString,h=u.hasOwnProperty,p=o.forEach,y=o.map,d=o.reduce,g=o.reduceRight,v=o.filter,m=o.every,b=o.some,w=o.indexOf,k=o.lastIndexOf,x=Array.isArray,_=Object.keys,O=a.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=A),n._=A):t._=A,A.VERSION="1.4.4";var $=A.each=A.forEach=function(t,e,n){if(null!=t)if(p&&t.forEach===p)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var u in t)if(A.has(t,u)&&e.call(n,t[u],u,t)===i)return};A.map=A.collect=function(t,e,n){var r=[];return null==t?r:y&&t.map===y?t.map(e,n):($(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),r)};var j="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(e=A.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if($(t,function(t,o,u){i?n=e.call(r,n,t,o,u):(n=t,i=!0)}),!i)throw new TypeError(j);return n},A.reduceRight=A.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return r&&(e=A.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var u=A.keys(t);o=u.length}if($(t,function(a,s,c){s=u?u[--o]:--o,i?n=e.call(r,n,t[s],s,c):(n=t[s],i=!0)}),!i)throw new TypeError(j);return n},A.find=A.detect=function(t,e,n){var r;return E(t,function(t,i,o){return e.call(n,t,i,o)?(r=t,!0):void 0}),r},A.filter=A.select=function(t,e,n){var r=[];return null==t?r:v&&t.filter===v?t.filter(e,n):($(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},A.reject=function(t,e,n){return A.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},A.every=A.all=function(t,e,n){e||(e=A.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):($(t,function(t,o,u){return(r=r&&e.call(n,t,o,u))?void 0:i}),!!r)};var E=A.some=A.any=function(t,e,n){e||(e=A.identity);var r=!1;return null==t?r:b&&t.some===b?t.some(e,n):($(t,function(t,o,u){return r||(r=e.call(n,t,o,u))?i:void 0}),!!r)};A.contains=A.include=function(t,e){return null==t?!1:w&&t.indexOf===w?-1!=t.indexOf(e):E(t,function(t){return t===e})},A.invoke=function(t,e){var n=c.call(arguments,2),r=A.isFunction(e);return A.map(t,function(t){return(r?e:t[e]).apply(t,n)})},A.pluck=function(t,e){return A.map(t,function(t){return t[e]})},A.where=function(t,e,n){return A.isEmpty(e)?n?null:[]:A[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},A.findWhere=function(t,e){return A.where(t,e,!0)},A.max=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&A.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return $(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u>=r.computed&&(r={value:t,computed:u})}),r.value},A.min=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&A.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return $(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u<r.computed&&(r={value:t,computed:u})}),r.value},A.shuffle=function(t){var e,n=0,r=[];return $(t,function(t){e=A.random(n++),r[n-1]=r[e],r[e]=t}),r};var S=function(t){return A.isFunction(t)?t:function(e){return e[t]}};A.sortBy=function(t,e,n){var r=S(e);return A.pluck(A.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var D=function(t,e,n,r){var i={},o=S(e||A.identity);return $(t,function(e,u){var a=o.call(n,e,u,t);r(i,a,e)}),i};A.groupBy=function(t,e,n){return D(t,e,n,function(t,e,n){(A.has(t,e)?t[e]:t[e]=[]).push(n)})},A.countBy=function(t,e,n){return D(t,e,n,function(t,e){A.has(t,e)||(t[e]=0),t[e]++})},A.sortedIndex=function(t,e,n,r){n=null==n?A.identity:S(n);for(var i=n.call(r,e),o=0,u=t.length;u>o;){var a=o+u>>>1;n.call(r,t[a])<i?o=a+1:u=a}return o},A.toArray=function(t){return t?A.isArray(t)?c.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:c.call(t,0,e)},A.initial=function(t,e,n){return c.call(t,0,t.length-(null==e||n?1:e))},A.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},A.rest=A.tail=A.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},A.compact=function(t){return A.filter(t,A.identity)};var M=function(t,e,n){return $(t,function(t){A.isArray(t)?e?s.apply(n,t):M(t,e,n):n.push(t)}),n};A.flatten=function(t,e){return M(t,e,[])},A.without=function(t){return A.difference(t,c.call(arguments,1))},A.uniq=A.unique=function(t,e,n,r){A.isFunction(e)&&(r=n,n=e,e=!1);var i=n?A.map(t,n,r):t,o=[],u=[];return $(i,function(n,r){(e?r&&u[u.length-1]===n:A.contains(u,n))||(u.push(n),o.push(t[r]))}),o},A.union=function(){return A.uniq(f.apply(o,arguments))},A.intersection=function(t){var e=c.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(e,function(e){return A.indexOf(e,t)>=0})})},A.difference=function(t){var e=f.apply(o,c.call(arguments,1));return A.filter(t,function(t){return!A.contains(e,t)})},A.zip=function(){for(var t=c.call(arguments),e=A.max(A.pluck(t,"length")),n=new Array(e),r=0;e>r;r++)n[r]=A.pluck(t,""+r);return n},A.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},A.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=A.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,i+n):n}if(w&&t.indexOf===w)return t.indexOf(e,n);for(;i>r;r++)if(t[r]===e)return r;return-1},A.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(k&&t.lastIndexOf===k)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},A.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=new Array(r);r>i;)o[i++]=t,t+=n;return o},A.bind=function(t,e){if(t.bind===O&&O)return O.apply(t,c.call(arguments,1));var n=c.call(arguments,2);return function(){return t.apply(e,n.concat(c.call(arguments)))}},A.partial=function(t){var e=c.call(arguments,1);return function(){return t.apply(this,e.concat(c.call(arguments)))}},A.bindAll=function(t){var e=c.call(arguments,1);return 0===e.length&&(e=A.functions(t)),$(e,function(e){t[e]=A.bind(t[e],t)}),t},A.memoize=function(t,e){var n={};return e||(e=A.identity),function(){var r=e.apply(this,arguments);return A.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},A.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(c.call(arguments,1)))},A.throttle=function(t,e){var n,r,i,o,u=0,a=function(){u=new Date,i=null,o=t.apply(n,r)};return function(){var s=new Date,c=e-(s-u);return n=this,r=arguments,0>=c?(clearTimeout(i),i=null,u=s,o=t.apply(n,r)):i||(i=setTimeout(a,c)),o}},A.debounce=function(t,e,n){var r,i;return function(){var o=this,u=arguments,a=function(){r=null,n||(i=t.apply(o,u))},s=n&&!r;return clearTimeout(r),r=setTimeout(a,e),s&&(i=t.apply(o,u)),i}},A.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},A.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},A.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},A.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},A.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)A.has(t,n)&&(e[e.length]=n);return e},A.values=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push(t[n]);return e},A.pairs=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push([n,t[n]]);return e},A.invert=function(t){var e={};for(var n in t)A.has(t,n)&&(e[t[n]]=n);return e},A.functions=A.methods=function(t){var e=[];for(var n in t)A.isFunction(t[n])&&e.push(n);return e.sort()},A.extend=function(t){return $(c.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},A.pick=function(t){var e={},n=f.apply(o,c.call(arguments,1));return $(n,function(n){n in t&&(e[n]=t[n])}),e},A.omit=function(t){var e={},n=f.apply(o,c.call(arguments,1));for(var r in t)A.contains(n,r)||(e[r]=t[r]);return e},A.defaults=function(t){return $(c.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,e){return e(t),t};var T=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof A&&(t=t._wrapped),e instanceof A&&(e=e._wrapped);var i=l.call(t);if(i!=l.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return r[o]==e;n.push(t),r.push(e);var u=0,a=!0;if("[object Array]"==i){if(u=t.length,a=u==e.length)for(;u--&&(a=T(t[u],e[u],n,r)););}else{var s=t.constructor,c=e.constructor;if(s!==c&&!(A.isFunction(s)&&s instanceof s&&A.isFunction(c)&&c instanceof c))return!1;for(var f in t)if(A.has(t,f)&&(u++,!(a=A.has(e,f)&&T(t[f],e[f],n,r))))break;if(a){for(f in e)if(A.has(e,f)&&!u--)break;a=!u}}return n.pop(),r.pop(),a};A.isEqual=function(t,e){return T(t,e,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var e in t)if(A.has(t,e))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=x||function(t){return"[object Array]"==l.call(t)},A.isObject=function(t){return t===Object(t)},$(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,e){return h.call(t,e)},A.noConflict=function(){return t._=r,this},A.identity=function(t){return t},A.times=function(t,e,n){for(var r=Array(t),i=0;t>i;i++)r[i]=e.call(n,i);return r},A.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=A.invert(N.escape);var P={escape:new RegExp("["+A.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(N.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(e){return null==e?"":(""+e).replace(P[t],function(e){return N[t][e]})}}),A.result=function(t,e){if(null==t)return null;var n=t[e];return A.isFunction(n)?n.call(t):n},A.mixin=function(t){$(A.functions(t),function(e){var n=A[e]=t[e];A.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),K.call(this,n.apply(A,t))}})};var C=0;A.uniqueId=function(t){var e=++C+"";return t?t+e:e},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,e,n){var r;n=A.defaults({},n,A.templateSettings);var i=new RegExp([(n.escape||I).source,(n.interpolate||I).source,(n.evaluate||I).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(i,function(e,n,r,i,a){return u+=t.slice(o,a).replace(q,function(t){return"\\"+F[t]}),n&&(u+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=a+e.length,e}),u+="';\n",n.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{r=new Function(n.variable||"obj","_",u)}catch(a){throw a.source=u,a}if(e)return r(e,A);var s=function(t){return r.call(this,t,A)};return s.source="function("+(n.variable||"obj")+"){\n"+u+"}",s},A.chain=function(t){return A(t).chain()};var K=function(t){return this._chain?A(t).chain():t};A.mixin(A),$(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];A.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],K.call(this,n)}}),$(["concat","join","slice"],function(t){var e=o[t];A.prototype[t]=function(){return K.call(this,e.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}]},{},[6])(6)});
(function(){function n(n,r,e){for(var t=(e||0)-1,o=n?n.length:0;++t<o;)if(n[t]===r)return t;return-1}function r(r,e){var t=typeof e;if(r=r.cache,"boolean"==t||null==e)return r[e]?0:-1;"number"!=t&&"string"!=t&&(t="object");var o="number"==t?e:m+e;return r=(r=r[t])&&r[o],"object"==t?r&&n(r,e)>-1?0:-1:r?0:-1}function e(n){var r=this.cache,e=typeof n;if("boolean"==e||null==n)r[n]=!0;else{"number"!=e&&"string"!=e&&(e="object");var t="number"==e?n:m+n,o=r[e]||(r[e]={});"object"==e?(o[t]||(o[t]=[])).push(n):o[t]=!0}}function t(n){return n.charCodeAt(0)}function o(n,r){for(var e=n.criteria,t=r.criteria,o=-1,u=e.length;++o<u;){var a=e[o],i=t[o];if(a!==i){if(a>i||"undefined"==typeof a)return 1;if(i>a||"undefined"==typeof i)return-1}}return n.index-r.index}function u(n){var r=-1,t=n.length,o=n[0],u=n[t/2|0],a=n[t-1];if(o&&"object"==typeof o&&u&&"object"==typeof u&&a&&"object"==typeof a)return!1;var i=l();i["false"]=i["null"]=i["true"]=i.undefined=!1;var c=l();for(c.array=n,c.cache=i,c.push=e;++r<t;)c.push(n[r]);return c}function a(n){return"\\"+Z[n]}function i(){return v.pop()||[]}function l(){return y.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function c(n){return"function"!=typeof n.toString&&"string"==typeof(n+"")}function f(n){n.length=0,v.length<w&&v.push(n)}function s(n){var r=n.cache;r&&s(r),n.array=n.cache=n.criteria=n.object=n.number=n.string=n.value=null,y.length<w&&y.push(n)}function p(n,r,e){r||(r=0),"undefined"==typeof e&&(e=n?n.length:0);for(var t=-1,o=e-r||0,u=Array(0>o?0:o);++t<o;)u[t]=n[r+t];return u}function g(e){function v(n){return n&&"object"==typeof n&&!fo(n)&&zt.call(n,"__wrapped__")?n:new y(n)}function y(n,r){this.__chain__=!!r,this.__wrapped__=n}function w(n){function r(){if(t){var n=p(t);Kt.apply(n,arguments)}if(this instanceof r){var u=rr(e.prototype),a=e.apply(u,n||arguments);return $r(a)?a:u}return e.apply(o,n||arguments)}var e=n[0],t=n[2],o=n[4];return co(r,n),r}function Z(n,r,e,t,o){if(e){var u=e(n);if("undefined"!=typeof u)return u}var a=$r(n);if(!a)return n;var l=Dt.call(n);if(!G[l]||!io.nodeClass&&c(n))return n;var s=uo[l];switch(l){case H:case W:return new s(+n);case K:case V:return new s(n);case M:return u=s(n.source,O.exec(n)),u.lastIndex=n.lastIndex,u}var g=fo(n);if(r){var h=!t;t||(t=i()),o||(o=i());for(var v=t.length;v--;)if(t[v]==n)return o[v];u=g?s(n.length):{}}else u=g?p(n):xo({},n);return g&&(zt.call(n,"index")&&(u.index=n.index),zt.call(n,"input")&&(u.input=n.input)),r?(t.push(n),o.push(u),(g?wo:Co)(n,function(n,a){u[a]=Z(n,r,e,t,o)}),h&&(f(t),f(o)),u):u}function rr(n){return $r(n)?Qt(n):{}}function er(n,r,e){if("function"!=typeof n)return ot;if("undefined"==typeof r||!("prototype"in n))return n;var t=n.__bindData__;if("undefined"==typeof t&&(io.funcNames&&(t=!n.name),t=t||!io.funcDecomp,!t)){var o=Wt.call(n);io.funcNames||(t=!S.test(o)),t||(t=N.test(o),co(n,t))}if(t===!1||t!==!0&&1&t[1])return n;switch(e){case 1:return function(e){return n.call(r,e)};case 2:return function(e,t){return n.call(r,e,t)};case 3:return function(e,t,o){return n.call(r,e,t,o)};case 4:return function(e,t,o,u){return n.call(r,e,t,o,u)}}return We(n,r)}function tr(n){function r(){var n=l?a:this;if(o){var h=p(o);Kt.apply(h,arguments)}if((u||f)&&(h||(h=p(arguments)),u&&Kt.apply(h,u),f&&h.length<i))return t|=16,tr([e,s?t:-4&t,h,null,a,i]);if(h||(h=arguments),c&&(e=n[g]),this instanceof r){n=rr(e.prototype);var v=e.apply(n,h);return $r(v)?v:n}return e.apply(n,h)}var e=n[0],t=n[1],o=n[2],u=n[3],a=n[4],i=n[5],l=1&t,c=2&t,f=4&t,s=8&t,g=e;return co(r,n),r}function or(e,t){var o=-1,a=vr(),i=e?e.length:0,l=i>=_&&a===n,c=[];if(l){var f=u(t);f?(a=r,t=f):l=!1}for(;++o<i;){var p=e[o];a(t,p)<0&&c.push(p)}return l&&s(t),c}function ar(n,r,e,t){for(var o=(t||0)-1,u=n?n.length:0,a=[];++o<u;){var i=n[o];if(i&&"object"==typeof i&&"number"==typeof i.length&&(fo(i)||mr(i))){r||(i=ar(i,r,e));var l=-1,c=i.length,f=a.length;for(a.length+=c;++l<c;)a[f++]=i[l]}else e||a.push(i)}return a}function ir(n,r,e,t,o,u){if(e){var a=e(n,r);if("undefined"!=typeof a)return!!a}if(n===r)return 0!==n||1/n==1/r;var l=typeof n,s=typeof r;if(!(n!==n||n&&Y[l]||r&&Y[s]))return!1;if(null==n||null==r)return n===r;var p=Dt.call(n),g=Dt.call(r);if(p==F&&(p=U),g==F&&(g=U),p!=g)return!1;switch(p){case H:case W:return+n==+r;case K:return n!=+n?r!=+r:0==n?1/n==1/r:n==+r;case M:case V:return n==St(r)}var h=p==B;if(!h){var v=zt.call(n,"__wrapped__"),y=zt.call(r,"__wrapped__");if(v||y)return ir(v?n.__wrapped__:n,y?r.__wrapped__:r,e,t,o,u);if(p!=U||!io.nodeClass&&(c(n)||c(r)))return!1;var b=!io.argsObject&&mr(n)?Et:n.constructor,d=!io.argsObject&&mr(r)?Et:r.constructor;if(b!=d&&!(Dr(b)&&b instanceof b&&Dr(d)&&d instanceof d)&&"constructor"in n&&"constructor"in r)return!1}var m=!o;o||(o=i()),u||(u=i());for(var _=o.length;_--;)if(o[_]==n)return u[_]==r;var w=0;if(a=!0,o.push(n),u.push(r),h){if(_=n.length,w=r.length,a=w==_,a||t)for(;w--;){var x=_,j=r[w];if(t)for(;x--&&!(a=ir(n[x],j,e,t,o,u)););else if(!(a=ir(n[w],j,e,t,o,u)))break}}else ko(r,function(r,i,l){return zt.call(l,i)?(w++,a=zt.call(n,i)&&ir(n[i],r,e,t,o,u)):void 0}),a&&!t&&ko(n,function(n,r,e){return zt.call(e,r)?a=--w>-1:void 0});return o.pop(),u.pop(),m&&(f(o),f(u)),a}function lr(n,r,e,t,o){(fo(r)?te:Co)(r,function(r,u){var a,i,l=r,c=n[u];if(r&&((i=fo(r))||Po(r))){for(var f=t.length;f--;)if(a=t[f]==r){c=o[f];break}if(!a){var s;e&&(l=e(c,r),(s="undefined"!=typeof l)&&(c=l)),s||(c=i?fo(c)?c:[]:Po(c)?c:{}),t.push(r),o.push(c),s||lr(c,r,e,t,o)}}else e&&(l=e(c,r),"undefined"==typeof l&&(l=r)),"undefined"!=typeof l&&(c=l);n[u]=c})}function cr(n,r){return n+Ht(oo()*(r-n+1))}function fr(e,t,o){var a=-1,l=vr(),c=e?e.length:0,p=[],g=!t&&c>=_&&l===n,h=o||g?i():p;if(g){var v=u(h);l=r,h=v}for(;++a<c;){var y=e[a],b=o?o(y,a,e):y;(t?!a||h[h.length-1]!==b:l(h,b)<0)&&((o||g)&&h.push(b),p.push(y))}return g?(f(h.array),s(h)):o&&f(h),p}function sr(n){return function(r,e,t){var o={};if(e=v.createCallback(e,t,3),fo(r))for(var u=-1,a=r.length;++u<a;){var i=r[u];n(o,i,e(i,u,r),r)}else wo(r,function(r,t,u){n(o,r,e(r,t,u),u)});return o}}function pr(n,r,e,t,o,u){var a=1&r,i=2&r,l=4&r,c=16&r,f=32&r;if(!i&&!Dr(n))throw new At;c&&!e.length&&(r&=-17,c=e=!1),f&&!t.length&&(r&=-33,f=t=!1);var s=n&&n.__bindData__;if(s&&s!==!0)return s=p(s),s[2]&&(s[2]=p(s[2])),s[3]&&(s[3]=p(s[3])),!a||1&s[1]||(s[4]=o),!a&&1&s[1]&&(r|=8),!l||4&s[1]||(s[5]=u),c&&Kt.apply(s[2]||(s[2]=[]),e),f&&Gt.apply(s[3]||(s[3]=[]),t),s[1]|=r,pr.apply(null,s);var g=1==r||17===r?w:tr;return g([n,r,e,t,o,u])}function gr(){X.shadowedProps=D,X.array=X.bottom=X.loop=X.top="",X.init="iterable",X.useHas=!0;for(var n,r=0;n=arguments[r];r++)for(var e in n)X[e]=n[e];var t=X.args;X.firstArg=/^[^,]+/.exec(t)[0];var o=kt("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+t+") {\n"+lo(X)+"\n}");return o(er,q,Lt,zt,d,mr,fo,qr,X.keys,Nt,Y,ao,V,Rt,Dt)}function hr(n){return yo[n]}function vr(){var r=(r=v.indexOf)===ke?n:r;return r}function yr(n){return"function"==typeof n&&$t.test(n)}function br(n){var r,e;return!n||Dt.call(n)!=U||(r=n.constructor,Dr(r)&&!(r instanceof r))||!io.argsClass&&mr(n)||!io.nodeClass&&c(n)?!1:io.ownLast?(ko(n,function(n,r,t){return e=zt.call(t,r),!1}),e!==!1):(ko(n,function(n,r){e=r}),"undefined"==typeof e||zt.call(n,e))}function dr(n){return bo[n]}function mr(n){return n&&"object"==typeof n&&"number"==typeof n.length&&Dt.call(n)==F||!1}function _r(n,r,e,t){return"boolean"!=typeof r&&null!=r&&(t=e,e=r,r=!1),Z(n,r,"function"==typeof e&&er(e,t,1))}function wr(n,r,e){return Z(n,!0,"function"==typeof r&&er(r,e,1))}function xr(n,r){var e=rr(n);return r?xo(e,r):e}function jr(n,r,e){var t;return r=v.createCallback(r,e,3),Co(n,function(n,e,o){return r(n,e,o)?(t=e,!1):void 0}),t}function kr(n,r,e){var t;return r=v.createCallback(r,e,3),Pr(n,function(n,e,o){return r(n,e,o)?(t=e,!1):void 0}),t}function Cr(n,r,e){var t=[];ko(n,function(n,r){t.push(r,n)});var o=t.length;for(r=er(r,e,3);o--&&r(t[o--],t[o],n)!==!1;);return n}function Pr(n,r,e){var t=po(n),o=t.length;for(r=er(r,e,3);o--;){var u=t[o];if(r(n[u],u,n)===!1)break}return n}function Er(n){var r=[];return ko(n,function(n,e){Dr(n)&&r.push(e)}),r.sort()}function Or(n,r){return n?zt.call(n,r):!1}function Sr(n){for(var r=-1,e=po(n),t=e.length,o={};++r<t;){var u=e[r];o[n[u]]=u}return o}function Ar(n){return n===!0||n===!1||n&&"object"==typeof n&&Dt.call(n)==H||!1}function Ir(n){return n&&"object"==typeof n&&Dt.call(n)==W||!1}function Lr(n){return n&&1===n.nodeType||!1}function Nr(n){var r=!0;if(!n)return r;var e=Dt.call(n),t=n.length;return e==B||e==V||(io.argsClass?e==F:mr(n))||e==U&&"number"==typeof t&&Dr(n.splice)?!t:(Co(n,function(){return r=!1}),r)}function Rr(n,r,e,t){return ir(n,r,"function"==typeof e&&er(e,t,2))}function Tr(n){return Yt(n)&&!Zt(parseFloat(n))}function Dr(n){return"function"==typeof n}function $r(n){return!(!n||!Y[typeof n])}function Fr(n){return Hr(n)&&n!=+n}function Br(n){return null===n}function Hr(n){return"number"==typeof n||n&&"object"==typeof n&&Dt.call(n)==K||!1}function Wr(n){return n&&Y[typeof n]&&Dt.call(n)==M||!1}function qr(n){return"string"==typeof n||n&&"object"==typeof n&&Dt.call(n)==V||!1}function zr(n){return"undefined"==typeof n}function Kr(n,r,e){var t={};return r=v.createCallback(r,e,3),Co(n,function(n,e,o){t[e]=r(n,e,o)}),t}function Ur(n){var r=arguments,e=2;if(!$r(n))return n;if("number"!=typeof r[2]&&(e=r.length),e>3&&"function"==typeof r[e-2])var t=er(r[--e-1],r[e--],2);else e>2&&"function"==typeof r[e-1]&&(t=r[--e]);for(var o=p(arguments,1,e),u=-1,a=i(),l=i();++u<e;)lr(n,o[u],t,a,l);return f(a),f(l),n}function Mr(n,r,e){var t={};if("function"!=typeof r){var o=[];ko(n,function(n,r){o.push(r)}),o=or(o,ar(arguments,!0,!1,1));for(var u=-1,a=o.length;++u<a;){var i=o[u];t[i]=n[i]}}else r=v.createCallback(r,e,3),ko(n,function(n,e,o){r(n,e,o)||(t[e]=n)});return t}function Vr(n){for(var r=-1,e=po(n),t=e.length,o=_t(t);++r<t;){var u=e[r];o[r]=[u,n[u]]}return o}function Gr(n,r,e){var t={};if("function"!=typeof r)for(var o=-1,u=ar(arguments,!0,!1,1),a=$r(n)?u.length:0;++o<a;){var i=u[o];i in n&&(t[i]=n[i])}else r=v.createCallback(r,e,3),ko(n,function(n,e,o){r(n,e,o)&&(t[e]=n)});return t}function Jr(n,r,e,t){var o=fo(n);if(null==e)if(o)e=[];else{var u=n&&n.constructor,a=u&&u.prototype;e=rr(a)}return r&&(r=v.createCallback(r,t,4),(o?wo:Co)(n,function(n,t,o){return r(e,n,t,o)})),e}function Qr(n){for(var r=-1,e=po(n),t=e.length,o=_t(t);++r<t;)o[r]=n[e[r]];return o}function Xr(n){var r=arguments,e=-1,t=ar(r,!0,!1,1),o=r[2]&&r[2][r[1]]===n?1:t.length,u=_t(o);for(io.unindexedChars&&qr(n)&&(n=n.split(""));++e<o;)u[e]=n[t[e]];return u}function Yr(n,r,e){var t=-1,o=vr(),u=n?n.length:0,a=!1;return e=(0>e?ro(0,u+e):e)||0,fo(n)?a=o(n,r,e)>-1:"number"==typeof u?a=(qr(n)?n.indexOf(r,e):o(n,r,e))>-1:wo(n,function(n){return++t>=e?!(a=n===r):void 0}),a}function Zr(n,r,e){var t=!0;if(r=v.createCallback(r,e,3),fo(n))for(var o=-1,u=n.length;++o<u&&(t=!!r(n[o],o,n)););else wo(n,function(n,e,o){return t=!!r(n,e,o)});return t}function ne(n,r,e){var t=[];if(r=v.createCallback(r,e,3),fo(n))for(var o=-1,u=n.length;++o<u;){var a=n[o];r(a,o,n)&&t.push(a)}else wo(n,function(n,e,o){r(n,e,o)&&t.push(n)});return t}function re(n,r,e){if(r=v.createCallback(r,e,3),!fo(n)){var t;return wo(n,function(n,e,o){return r(n,e,o)?(t=n,!1):void 0}),t}for(var o=-1,u=n.length;++o<u;){var a=n[o];if(r(a,o,n))return a}}function ee(n,r,e){var t;return r=v.createCallback(r,e,3),oe(n,function(n,e,o){return r(n,e,o)?(t=n,!1):void 0}),t}function te(n,r,e){if(r&&"undefined"==typeof e&&fo(n))for(var t=-1,o=n.length;++t<o&&r(n[t],t,n)!==!1;);else wo(n,r,e);return n}function oe(n,r,e){var t=n,o=n?n.length:0;if(r=r&&"undefined"==typeof e?r:er(r,e,3),fo(n))for(;o--&&r(n[o],o,n)!==!1;);else{if("number"!=typeof o){var u=po(n);o=u.length}else io.unindexedChars&&qr(n)&&(t=n.split(""));wo(n,function(n,e,a){return e=u?u[--o]:--o,r(t[e],e,a)})}return n}function ue(n,r){var e=p(arguments,2),t=-1,o="function"==typeof r,u=n?n.length:0,a=_t("number"==typeof u?u:0);return te(n,function(n){a[++t]=(o?r:n[r]).apply(n,e)}),a}function ae(n,r,e){var t=-1,o=n?n.length:0,u=_t("number"==typeof o?o:0);if(r=v.createCallback(r,e,3),fo(n))for(;++t<o;)u[t]=r(n[t],t,n);else wo(n,function(n,e,o){u[++t]=r(n,e,o)});return u}function ie(n,r,e){var o=-1/0,u=o;if("function"!=typeof r&&e&&e[r]===n&&(r=null),null==r&&fo(n))for(var a=-1,i=n.length;++a<i;){var l=n[a];l>u&&(u=l)}else r=null==r&&qr(n)?t:v.createCallback(r,e,3),wo(n,function(n,e,t){var a=r(n,e,t);a>o&&(o=a,u=n)});return u}function le(n,r,e){var o=1/0,u=o;if("function"!=typeof r&&e&&e[r]===n&&(r=null),null==r&&fo(n))for(var a=-1,i=n.length;++a<i;){var l=n[a];u>l&&(u=l)}else r=null==r&&qr(n)?t:v.createCallback(r,e,3),wo(n,function(n,e,t){var a=r(n,e,t);o>a&&(o=a,u=n)});return u}function ce(n,r,e,t){var o=arguments.length<3;if(r=v.createCallback(r,t,4),fo(n)){var u=-1,a=n.length;for(o&&(e=n[++u]);++u<a;)e=r(e,n[u],u,n)}else wo(n,function(n,t,u){e=o?(o=!1,n):r(e,n,t,u)});return e}function fe(n,r,e,t){var o=arguments.length<3;return r=v.createCallback(r,t,4),oe(n,function(n,t,u){e=o?(o=!1,n):r(e,n,t,u)}),e}function se(n,r,e){return r=v.createCallback(r,e,3),ne(n,function(n,e,t){return!r(n,e,t)})}function pe(n,r,e){if(n&&"number"!=typeof n.length?n=Qr(n):io.unindexedChars&&qr(n)&&(n=n.split("")),null==r||e)return n?n[cr(0,n.length-1)]:h;var t=ge(n);return t.length=eo(ro(0,r),t.length),t}function ge(n){var r=-1,e=n?n.length:0,t=_t("number"==typeof e?e:0);return te(n,function(n){var e=cr(0,++r);t[r]=t[e],t[e]=n}),t}function he(n){var r=n?n.length:0;return"number"==typeof r?r:po(n).length}function ve(n,r,e){var t;if(r=v.createCallback(r,e,3),fo(n))for(var o=-1,u=n.length;++o<u&&!(t=r(n[o],o,n)););else wo(n,function(n,e,o){return!(t=r(n,e,o))});return!!t}function ye(n,r,e){var t=-1,u=fo(r),a=n?n.length:0,c=_t("number"==typeof a?a:0);for(u||(r=v.createCallback(r,e,3)),te(n,function(n,e,o){var a=c[++t]=l();u?a.criteria=ae(r,function(r){return n[r]}):(a.criteria=i())[0]=r(n,e,o),a.index=t,a.value=n}),a=c.length,c.sort(o);a--;){var p=c[a];c[a]=p.value,u||f(p.criteria),s(p)}return c}function be(n){return n&&"number"==typeof n.length?io.unindexedChars&&qr(n)?n.split(""):p(n):Qr(n)}function de(n){for(var r=-1,e=n?n.length:0,t=[];++r<e;){var o=n[r];o&&t.push(o)}return t}function me(n){return or(n,ar(arguments,!0,!0,1))}function _e(n,r,e){var t=-1,o=n?n.length:0;for(r=v.createCallback(r,e,3);++t<o;)if(r(n[t],t,n))return t;return-1}function we(n,r,e){var t=n?n.length:0;for(r=v.createCallback(r,e,3);t--;)if(r(n[t],t,n))return t;return-1}function xe(n,r,e){var t=0,o=n?n.length:0;if("number"!=typeof r&&null!=r){var u=-1;for(r=v.createCallback(r,e,3);++u<o&&r(n[u],u,n);)t++}else if(t=r,null==t||e)return n?n[0]:h;return p(n,0,eo(ro(0,t),o))}function je(n,r,e,t){return"boolean"!=typeof r&&null!=r&&(t=e,e="function"!=typeof r&&t&&t[r]===n?null:r,r=!1),null!=e&&(n=ae(n,e,t)),ar(n,r)}function ke(r,e,t){if("number"==typeof t){var o=r?r.length:0;t=0>t?ro(0,o+t):t||0}else if(t){var u=Ne(r,e);return r[u]===e?u:-1}return n(r,e,t)}function Ce(n,r,e){var t=0,o=n?n.length:0;if("number"!=typeof r&&null!=r){var u=o;for(r=v.createCallback(r,e,3);u--&&r(n[u],u,n);)t++}else t=null==r||e?1:r||t;return p(n,0,eo(ro(0,o-t),o))}function Pe(){for(var e=[],t=-1,o=arguments.length,a=i(),l=vr(),c=l===n,p=i();++t<o;){var g=arguments[t];(fo(g)||mr(g))&&(e.push(g),a.push(c&&g.length>=_&&u(t?e[t]:p)))}var h=e[0],v=-1,y=h?h.length:0,b=[];n:for(;++v<y;){var d=a[0];if(g=h[v],(d?r(d,g):l(p,g))<0){for(t=o,(d||p).push(g);--t;)if(d=a[t],(d?r(d,g):l(e[t],g))<0)continue n;b.push(g)}}for(;o--;)d=a[o],d&&s(d);return f(a),f(p),b}function Ee(n,r,e){var t=0,o=n?n.length:0;if("number"!=typeof r&&null!=r){var u=o;for(r=v.createCallback(r,e,3);u--&&r(n[u],u,n);)t++}else if(t=r,null==t||e)return n?n[o-1]:h;return p(n,ro(0,o-t))}function Oe(n,r,e){var t=n?n.length:0;for("number"==typeof e&&(t=(0>e?ro(0,t+e):eo(e,t-1))+1);t--;)if(n[t]===r)return t;return-1}function Se(n){for(var r=arguments,e=0,t=r.length,o=n?n.length:0;++e<t;)for(var u=-1,a=r[e];++u<o;)n[u]===a&&(Vt.call(n,u--,1),o--);return n}function Ae(n,r,e){n=+n||0,e="number"==typeof e?e:+e||1,null==r&&(r=n,n=0);for(var t=-1,o=ro(0,Ft((r-n)/(e||1))),u=_t(o);++t<o;)u[t]=n,n+=e;return u}function Ie(n,r,e){var t=-1,o=n?n.length:0,u=[];for(r=v.createCallback(r,e,3);++t<o;){var a=n[t];r(a,t,n)&&(u.push(a),Vt.call(n,t--,1),o--)}return u}function Le(n,r,e){if("number"!=typeof r&&null!=r){var t=0,o=-1,u=n?n.length:0;for(r=v.createCallback(r,e,3);++o<u&&r(n[o],o,n);)t++}else t=null==r||e?1:ro(0,r);return p(n,t)}function Ne(n,r,e,t){var o=0,u=n?n.length:o;for(e=e?v.createCallback(e,t,1):ot,r=e(r);u>o;){var a=o+u>>>1;e(n[a])<r?o=a+1:u=a}return o}function Re(){return fr(ar(arguments,!0,!0))}function Te(n,r,e,t){return"boolean"!=typeof r&&null!=r&&(t=e,e="function"!=typeof r&&t&&t[r]===n?null:r,r=!1),null!=e&&(e=v.createCallback(e,t,3)),fr(n,r,e)}function De(n){return or(n,p(arguments,1))}function $e(){for(var n=-1,r=arguments.length;++n<r;){var e=arguments[n];if(fo(e)||mr(e))var t=t?fr(or(t,e).concat(or(e,t))):e}return t||[]}function Fe(){for(var n=arguments.length>1?arguments:arguments[0],r=-1,e=n?ie(Ao(n,"length")):0,t=_t(0>e?0:e);++r<e;)t[r]=Ao(n,r);return t}function Be(n,r){var e=-1,t=n?n.length:0,o={};for(r||!t||fo(n[0])||(r=[]);++e<t;){var u=n[e];r?o[u]=r[e]:u&&(o[u[0]]=u[1])}return o}function He(n,r){if(!Dr(r))throw new At;return function(){return--n<1?r.apply(this,arguments):void 0}}function We(n,r){return arguments.length>2?pr(n,17,p(arguments,2),null,r):pr(n,1,null,null,r)}function qe(n){for(var r=arguments.length>1?ar(arguments,!0,!1,1):Er(n),e=-1,t=r.length;++e<t;){var o=r[e];n[o]=pr(n[o],1,null,null,n)}return n}function ze(n,r){return arguments.length>2?pr(r,19,p(arguments,2),null,n):pr(r,3,null,null,n)}function Ke(){for(var n=arguments,r=n.length;r--;)if(!Dr(n[r]))throw new At;return function(){for(var r=arguments,e=n.length;e--;)r=[n[e].apply(this,r)];return r[0]}}function Ue(n,r){return r="number"==typeof r?r:+r||n.length,pr(n,4,null,null,null,r)}function Me(n,r,e){var t,o,u,a,i,l,c,f=0,s=!1,p=!0;if(!Dr(n))throw new At;if(r=ro(0,r)||0,e===!0){var g=!0;p=!1}else $r(e)&&(g=e.leading,s="maxWait"in e&&(ro(r,e.maxWait)||0),p="trailing"in e?e.trailing:p);var v=function(){var e=r-(Lo()-a);if(0>=e){o&&Bt(o);var s=c;o=l=c=h,s&&(f=Lo(),u=n.apply(i,t),l||o||(t=i=null))}else l=Mt(v,e)},y=function(){l&&Bt(l),o=l=c=h,(p||s!==r)&&(f=Lo(),u=n.apply(i,t),l||o||(t=i=null))};return function(){if(t=arguments,a=Lo(),i=this,c=p&&(l||!g),s===!1)var e=g&&!l;else{o||g||(f=a);var h=s-(a-f),b=0>=h;b?(o&&(o=Bt(o)),f=a,u=n.apply(i,t)):o||(o=Mt(y,h))}return b&&l?l=Bt(l):l||r===s||(l=Mt(v,r)),e&&(b=!0,u=n.apply(i,t)),!b||l||o||(t=i=null),u}}function Ve(n){if(!Dr(n))throw new At;var r=p(arguments,1);return Mt(function(){n.apply(h,r)},1)}function Ge(n,r){if(!Dr(n))throw new At;var e=p(arguments,2);return Mt(function(){n.apply(h,e)},r)}function Je(n,r){if(!Dr(n))throw new At;var e=function(){var t=e.cache,o=r?r.apply(this,arguments):m+arguments[0];return zt.call(t,o)?t[o]:t[o]=n.apply(this,arguments)};return e.cache={},e}function Qe(n){var r,e;if(!Dr(n))throw new At;return function(){return r?e:(r=!0,e=n.apply(this,arguments),n=null,e)}}function Xe(n){return pr(n,16,p(arguments,1))}function Ye(n){return pr(n,32,null,p(arguments,1))}function Ze(n,r,e){var t=!0,o=!0;if(!Dr(n))throw new At;return e===!1?t=!1:$r(e)&&(t="leading"in e?e.leading:t,o="trailing"in e?e.trailing:o),J.leading=t,J.maxWait=r,J.trailing=o,Me(n,r,J)}function nt(n,r){return pr(r,16,[n])}function rt(n){return function(){return n}}function et(n,r,e){var t=typeof n;if(null==n||"function"==t)return er(n,r,e);if("object"!=t)return lt(n);var o=po(n),u=o[0],a=n[u];return 1!=o.length||a!==a||$r(a)?function(r){for(var e=o.length,t=!1;e--&&(t=ir(r[o[e]],n[o[e]],null,!0)););return t}:function(n){var r=n[u];return a===r&&(0!==a||1/a==1/r)}}function tt(n){return null==n?"":St(n).replace(_o,hr)}function ot(n){return n}function ut(n,r,e){var t=!0,o=r&&Er(r);r&&(e||o.length)||(null==e&&(e=r),u=y,r=n,n=v,o=Er(r)),e===!1?t=!1:$r(e)&&"chain"in e&&(t=e.chain);var u=n,a=Dr(u);te(o,function(e){var o=n[e]=r[e];a&&(u.prototype[e]=function(){var r=this.__chain__,e=this.__wrapped__,a=[e];Kt.apply(a,arguments);var i=o.apply(n,a);if(t||r){if(e===i&&$r(i))return this;i=new u(i),i.__chain__=r}return i})})}function at(){return e._=Tt,this}function it(){}function lt(n){return function(r){return r[n]}}function ct(n,r,e){var t=null==n,o=null==r;if(null==e&&("boolean"==typeof n&&o?(e=n,n=1):o||"boolean"!=typeof r||(e=r,o=!0)),t&&o&&(r=1),n=+n||0,o?(r=n,n=0):r=+r||0,e||n%1||r%1){var u=oo();return eo(n+u*(r-n+parseFloat("1e-"+((u+"").length-1))),r)}return cr(n,r)}function ft(n,r){if(n){var e=n[r];return Dr(e)?n[r]():e}}function st(n,r,e){var t=v.templateSettings;n=St(n||""),e=jo({},e,t);var o,u=jo({},e.imports,t.imports),i=po(u),l=Qr(u),c=0,f=e.interpolate||L,s="__p += '",p=Ot((e.escape||L).source+"|"+f.source+"|"+(f===A?E:L).source+"|"+(e.evaluate||L).source+"|$","g");n.replace(p,function(r,e,t,u,i,l){return t||(t=u),s+=n.slice(c,l).replace(R,a),e&&(s+="' +\n__e("+e+") +\n'"),i&&(o=!0,s+="';\n"+i+";\n__p += '"),t&&(s+="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'"),c=l+r.length,r}),s+="';\n";var g=e.variable,y=g;y||(g="obj",s="with ("+g+") {\n"+s+"\n}\n"),s=(o?s.replace(j,""):s).replace(C,"$1").replace(P,"$1;"),s="function("+g+") {\n"+(y?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+s+"return __p\n}";var b="\n/*\n//# sourceURL="+(e.sourceURL||"/lodash/template/source["+$++ +"]")+"\n*/";try{var d=kt(i,"return "+s+b).apply(h,l)}catch(m){throw m.source=s,m}return r?d(r):(d.source=s,d)}function pt(n,r,e){n=(n=+n)>-1?n:0;var t=-1,o=_t(n);for(r=er(r,e,1);++t<n;)o[t]=r(t);return o}function gt(n){return null==n?"":St(n).replace(mo,dr)}function ht(n){var r=++b;return St(null==n?"":n)+r}function vt(n){return n=new y(n),n.__chain__=!0,n}function yt(n,r){return r(n),n}function bt(){return this.__chain__=!0,this}function dt(){return St(this.__wrapped__)}function mt(){return this.__wrapped__}e=e?ur.defaults(nr.Object(),e,ur.pick(nr,T)):nr;var _t=e.Array,wt=e.Boolean,xt=e.Date,jt=e.Error,kt=e.Function,Ct=e.Math,Pt=e.Number,Et=e.Object,Ot=e.RegExp,St=e.String,At=e.TypeError,It=[],Lt=jt.prototype,Nt=Et.prototype,Rt=St.prototype,Tt=e._,Dt=Nt.toString,$t=Ot("^"+St(Dt).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ft=Ct.ceil,Bt=e.clearTimeout,Ht=Ct.floor,Wt=kt.prototype.toString,qt=yr(qt=Et.getPrototypeOf)&&qt,zt=Nt.hasOwnProperty,Kt=It.push,Ut=Nt.propertyIsEnumerable,Mt=e.setTimeout,Vt=It.splice,Gt=It.unshift,Jt=function(){try{var n={},r=yr(r=Et.defineProperty)&&r,e=r(n,n,n)&&r}catch(t){}return e}(),Qt=yr(Qt=Et.create)&&Qt,Xt=yr(Xt=_t.isArray)&&Xt,Yt=e.isFinite,Zt=e.isNaN,no=yr(no=Et.keys)&&no,ro=Ct.max,eo=Ct.min,to=e.parseInt,oo=Ct.random,uo={};uo[B]=_t,uo[H]=wt,uo[W]=xt,uo[z]=kt,uo[U]=Et,uo[K]=Pt,uo[M]=Ot,uo[V]=St;var ao={};ao[B]=ao[W]=ao[K]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},ao[H]=ao[V]={constructor:!0,toString:!0,valueOf:!0},ao[q]=ao[z]=ao[M]={constructor:!0,toString:!0},ao[U]={constructor:!0},function(){for(var n=D.length;n--;){var r=D[n];for(var e in ao)zt.call(ao,e)&&!zt.call(ao[e],r)&&(ao[e][r]=!1)}}(),y.prototype=v.prototype;var io=v.support={};!function(){var n=function(){this.x=1},r={0:1,length:1},t=[];n.prototype={valueOf:1,y:1};for(var o in new n)t.push(o);for(o in arguments);io.argsClass=Dt.call(arguments)==F,io.argsObject=arguments.constructor==Et&&!(arguments instanceof _t),io.enumErrorProps=Ut.call(Lt,"message")||Ut.call(Lt,"name"),io.enumPrototypes=Ut.call(n,"prototype"),io.funcDecomp=!yr(e.WinRTError)&&N.test(g),io.funcNames="string"==typeof kt.name,io.nonEnumArgs=0!=o,io.nonEnumShadows=!/valueOf/.test(t),io.ownLast="x"!=t[0],io.spliceObjects=(It.splice.call(r,0,1),!r[0]),io.unindexedChars="x"[0]+Et("x")[0]!="xx";try{io.nodeClass=!(Dt.call(document)==U&&!({toString:0}+""))}catch(u){io.nodeClass=!0}}(1),v.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:A,variable:"",imports:{_:v}};var lo=function(n){var r="var index, iterable = "+n.firstArg+", result = "+n.init+";\nif (!iterable) return result;\n"+n.top+";";n.array?(r+="\nvar length = iterable.length; index = -1;\nif ("+n.array+") {  ",io.unindexedChars&&(r+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),r+="\n  while (++index < length) {\n    "+n.loop+";\n  }\n}\nelse {  "):io.nonEnumArgs&&(r+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+n.loop+";\n    }\n  } else {  "),io.enumPrototypes&&(r+="\n  var skipProto = typeof iterable == 'function';\n  "),io.enumErrorProps&&(r+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var e=[];if(io.enumPrototypes&&e.push('!(skipProto && index == "prototype")'),io.enumErrorProps&&e.push('!(skipErrorProps && (index == "message" || index == "name"))'),n.useHas&&n.keys)r+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",e.length&&(r+="    if ("+e.join(" && ")+") {\n  "),r+=n.loop+";    ",e.length&&(r+="\n    }"),r+="\n  }  ";else if(r+="\n  for (index in iterable) {\n",n.useHas&&e.push("hasOwnProperty.call(iterable, index)"),e.length&&(r+="    if ("+e.join(" && ")+") {\n  "),r+=n.loop+";    ",e.length&&(r+="\n    }"),r+="\n  }    ",io.nonEnumShadows){for(r+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)r+="\n    index = '"+n.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",n.useHas||(r+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),r+=") {\n      "+n.loop+";\n    }      ";r+="\n  }    "}return(n.array||io.nonEnumArgs)&&(r+="\n}"),r+=n.bottom+";\nreturn result"};Qt||(rr=function(){function n(){}return function(r){if($r(r)){n.prototype=r;var t=new n;n.prototype=null}return t||e.Object()}}());var co=Jt?function(n,r){Q.value=r,Jt(n,"__bindData__",Q)}:it;io.argsClass||(mr=function(n){return n&&"object"==typeof n&&"number"==typeof n.length&&zt.call(n,"callee")&&!Ut.call(n,"callee")||!1});var fo=Xt||function(n){return n&&"object"==typeof n&&"number"==typeof n.length&&Dt.call(n)==B||!1},so=gr({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),po=no?function(n){return $r(n)?io.enumPrototypes&&"function"==typeof n||io.nonEnumArgs&&n.length&&mr(n)?so(n):no(n):[]}:so,go={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:po,loop:"if (callback(iterable[index], index, collection) === false) return result"},ho={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:po,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},vo={top:"if (!objectTypes[typeof iterable]) return result;\n"+go.top,array:!1},yo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},bo=Sr(yo),mo=Ot("("+po(bo).join("|")+")","g"),_o=Ot("["+po(yo).join("")+"]","g"),wo=gr(go),xo=gr(ho,{top:ho.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),jo=gr(ho),ko=gr(go,vo,{useHas:!1}),Co=gr(go,vo);Dr(/x/)&&(Dr=function(n){return"function"==typeof n&&Dt.call(n)==z});var Po=qt?function(n){if(!n||Dt.call(n)!=U||!io.argsClass&&mr(n))return!1;var r=n.valueOf,e=yr(r)&&(e=qt(r))&&qt(e);return e?n==e||qt(n)==e:br(n)}:br,Eo=sr(function(n,r,e){zt.call(n,e)?n[e]++:n[e]=1}),Oo=sr(function(n,r,e){(zt.call(n,e)?n[e]:n[e]=[]).push(r)}),So=sr(function(n,r,e){n[e]=r}),Ao=ae,Io=ne,Lo=yr(Lo=xt.now)&&Lo||function(){return(new xt).getTime()},No=8==to(x+"08")?to:function(n,r){return to(qr(n)?n.replace(I,""):n,r||0)};return v.after=He,v.assign=xo,v.at=Xr,v.bind=We,v.bindAll=qe,v.bindKey=ze,v.chain=vt,v.compact=de,v.compose=Ke,v.constant=rt,v.countBy=Eo,v.create=xr,v.createCallback=et,v.curry=Ue,v.debounce=Me,v.defaults=jo,v.defer=Ve,v.delay=Ge,v.difference=me,v.filter=ne,v.flatten=je,v.forEach=te,v.forEachRight=oe,v.forIn=ko,v.forInRight=Cr,v.forOwn=Co,v.forOwnRight=Pr,v.functions=Er,v.groupBy=Oo,v.indexBy=So,v.initial=Ce,v.intersection=Pe,v.invert=Sr,v.invoke=ue,v.keys=po,v.map=ae,v.mapValues=Kr,v.max=ie,v.memoize=Je,v.merge=Ur,v.min=le,v.omit=Mr,v.once=Qe,v.pairs=Vr,v.partial=Xe,v.partialRight=Ye,v.pick=Gr,v.pluck=Ao,v.property=lt,v.pull=Se,v.range=Ae,v.reject=se,v.remove=Ie,v.rest=Le,v.shuffle=ge,v.sortBy=ye,v.tap=yt,v.throttle=Ze,v.times=pt,v.toArray=be,v.transform=Jr,v.union=Re,v.uniq=Te,v.values=Qr,v.where=Io,v.without=De,v.wrap=nt,v.xor=$e,v.zip=Fe,v.zipObject=Be,v.collect=ae,v.drop=Le,v.each=te,v.eachRight=oe,v.extend=xo,v.methods=Er,v.object=Be,v.select=ne,v.tail=Le,v.unique=Te,v.unzip=Fe,ut(v),v.clone=_r,v.cloneDeep=wr,v.contains=Yr,v.escape=tt,v.every=Zr,v.find=re,v.findIndex=_e,v.findKey=jr,v.findLast=ee,v.findLastIndex=we,v.findLastKey=kr,v.has=Or,v.identity=ot,v.indexOf=ke,v.isArguments=mr,v.isArray=fo,v.isBoolean=Ar,v.isDate=Ir,v.isElement=Lr,v.isEmpty=Nr,v.isEqual=Rr,v.isFinite=Tr,v.isFunction=Dr,v.isNaN=Fr,v.isNull=Br,v.isNumber=Hr,v.isObject=$r,v.isPlainObject=Po,v.isRegExp=Wr,v.isString=qr,v.isUndefined=zr,v.lastIndexOf=Oe,v.mixin=ut,v.noConflict=at,v.noop=it,v.now=Lo,v.parseInt=No,v.random=ct,v.reduce=ce,v.reduceRight=fe,v.result=ft,v.runInContext=g,v.size=he,v.some=ve,v.sortedIndex=Ne,v.template=st,v.unescape=gt,v.uniqueId=ht,v.all=Zr,v.any=ve,v.detect=re,v.findWhere=re,v.foldl=ce,v.foldr=fe,v.include=Yr,v.inject=ce,ut(function(){var n={};return Co(v,function(r,e){v.prototype[e]||(n[e]=r)}),n}(),!1),v.first=xe,v.last=Ee,v.sample=pe,v.take=xe,v.head=xe,Co(v,function(n,r){var e="sample"!==r;v.prototype[r]||(v.prototype[r]=function(r,t){var o=this.__chain__,u=n(this.__wrapped__,r,t);return o||null!=r&&(!t||e&&"function"==typeof r)?new y(u,o):u})}),v.VERSION="2.4.1",v.prototype.chain=bt,v.prototype.toString=dt,v.prototype.value=mt,v.prototype.valueOf=mt,wo(["join","pop","shift"],function(n){var r=It[n];v.prototype[n]=function(){var n=this.__chain__,e=r.apply(this.__wrapped__,arguments);return n?new y(e,n):e}}),wo(["push","reverse","sort","unshift"],function(n){var r=It[n];v.prototype[n]=function(){return r.apply(this.__wrapped__,arguments),this}}),wo(["concat","slice","splice"],function(n){var r=It[n];v.prototype[n]=function(){return new y(r.apply(this.__wrapped__,arguments),this.__chain__)}}),io.spliceObjects||wo(["pop","shift","splice"],function(n){var r=It[n],e="splice"==n;v.prototype[n]=function(){var n=this.__chain__,t=this.__wrapped__,o=r.apply(t,arguments);return 0===t.length&&delete t[0],n||e?new y(o,n):o}}),v}var h,v=[],y=[],b=0,d={},m=+new Date+"",_=75,w=40,x=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",j=/\b__p \+= '';/g,C=/\b(__p \+=) '' \+/g,P=/(__e\(.*?\)|\b__t\)) \+\n'';/g,E=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,O=/\w*$/,S=/^\s*function[ \n\r\t]+\w/,A=/<%=([\s\S]+?)%>/g,I=RegExp("^["+x+"]*0+(?=.$)"),L=/($^)/,N=/\bthis\b/,R=/['\n\r\t\u2028\u2029\\]/g,T=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],D=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],$=0,F="[object Arguments]",B="[object Array]",H="[object Boolean]",W="[object Date]",q="[object Error]",z="[object Function]",K="[object Number]",U="[object Object]",M="[object RegExp]",V="[object String]",G={};
G[z]=!1,G[F]=G[B]=G[H]=G[W]=G[K]=G[U]=G[M]=G[V]=!0;var J={leading:!1,maxWait:0,trailing:!1},Q={configurable:!1,enumerable:!1,value:null,writable:!1},X={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},Y={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Z={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},nr=Y[typeof window]&&window||this,rr=Y[typeof exports]&&exports&&!exports.nodeType&&exports,er=Y[typeof module]&&module&&!module.nodeType&&module,tr=er&&er.exports===rr&&rr,or=Y[typeof global]&&global;!or||or.global!==or&&or.window!==or||(nr=or);var ur=g();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(nr._=ur,define(function(){return ur})):rr&&er?tr?(er.exports=ur)._=ur:rr._=ur:nr._=ur}).call(this);
!function(e,t,r){"function"==typeof define?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():r[e]=t()}("IDBStore",function(){"use strict";var e=function(e){throw e},t={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:e,indexes:[]},r=function(e,r){"undefined"==typeof r&&"function"==typeof e&&(r=e),"[object Object]"!=Object.prototype.toString.call(e)&&(e={});for(var n in t)this[n]="undefined"!=typeof e[n]?e[n]:t[n];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,r&&(this.onStoreReady=r);var o="object"==typeof window?window:self;this.idb=o.indexedDB||o.webkitIndexedDB||o.mozIndexedDB,this.keyRange=o.IDBKeyRange||o.webkitIDBKeyRange||o.mozIDBKeyRange,this.features={hasAutoIncrement:!o.mozIndexedDB},this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()};r.prototype={constructor:r,version:"1.4.1",db:null,dbName:null,dbVersion:null,store:null,storeName:null,keyPath:null,autoIncrement:null,indexes:null,features:null,onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var e=this.idb.open(this.dbName,this.dbVersion),t=!1;e.onerror=function(e){var t=!1;"error"in e.target?t="VersionError"==e.target.error.name:"errorCode"in e.target&&(t=12==e.target.errorCode),this.onError(t?new Error("The version number provided is lower than the existing one."):e)}.bind(this),e.onsuccess=function(e){if(!t){if(this.db)return void this.onStoreReady();if(this.db=e.target.result,"string"==typeof this.db.version)return void this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));if(!this.db.objectStoreNames.contains(this.storeName))return void this.onError(new Error("Something is wrong with the IndexedDB implementation in this browser. Please upgrade your browser."));var r=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=r.objectStore(this.storeName);var n=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(e){var r=e.name;if(!r)return t=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(e),this.hasIndex(r)){var o=this.store.index(r),i=this.indexComplies(o,e);i||(t=!0,this.onError(new Error('Cannot modify index "'+r+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),n.splice(n.indexOf(r),1)}else t=!0,this.onError(new Error('Cannot create new index "'+r+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))},this),n.length&&(t=!0,this.onError(new Error('Cannot delete index(es) "'+n.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),t||this.onStoreReady()}}.bind(this),e.onupgradeneeded=function(e){if(this.db=e.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=e.target.transaction.objectStore(this.storeName);else{var r={autoIncrement:this.autoIncrement};null!==this.keyPath&&(r.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,r)}var n=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(e){var r=e.name;if(r||(t=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(e),this.hasIndex(r)){var o=this.store.index(r),i=this.indexComplies(o,e);i||(this.store.deleteIndex(r),this.store.createIndex(r,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})),n.splice(n.indexOf(r),1)}else this.store.createIndex(r,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})},this),n.length&&n.forEach(function(e){this.store.deleteIndex(e)},this)}.bind(this)},deleteDatabase:function(){this.idb.deleteDatabase&&this.idb.deleteDatabase(this.dbName)},put:function(t,r,o,i){null!==this.keyPath&&(i=o,o=r,r=t),i||(i=e),o||(o=n);var s,a=!1,u=null,c=this.db.transaction([this.storeName],this.consts.READ_WRITE);return c.oncomplete=function(){var e=a?o:i;e(u)},c.onabort=i,c.onerror=i,null!==this.keyPath?(this._addIdPropertyIfNeeded(r),s=c.objectStore(this.storeName).put(r)):s=c.objectStore(this.storeName).put(r,t),s.onsuccess=function(e){a=!0,u=e.target.result},s.onerror=i,c},get:function(t,r,o){o||(o=e),r||(r=n);var i=!1,s=null,a=this.db.transaction([this.storeName],this.consts.READ_ONLY);a.oncomplete=function(){var e=i?r:o;e(s)},a.onabort=o,a.onerror=o;var u=a.objectStore(this.storeName).get(t);return u.onsuccess=function(e){i=!0,s=e.target.result},u.onerror=o,a},remove:function(t,r,o){o||(o=e),r||(r=n);var i=!1,s=null,a=this.db.transaction([this.storeName],this.consts.READ_WRITE);a.oncomplete=function(){var e=i?r:o;e(s)},a.onabort=o,a.onerror=o;var u=a.objectStore(this.storeName)["delete"](t);return u.onsuccess=function(e){i=!0,s=e.target.result},u.onerror=o,a},batch:function(t,r,o){o||(o=e),r||(r=n),"[object Array]"!=Object.prototype.toString.call(t)&&o(new Error("dataArray argument must be of type Array."));var i=this.db.transaction([this.storeName],this.consts.READ_WRITE);i.oncomplete=function(){var e=u?r:o;e(u)},i.onabort=o,i.onerror=o;var s=t.length,a=!1,u=!1,c=function(){s--,0!==s||a||(a=!0,u=!0)};return t.forEach(function(e){var t=e.type,r=e.key,n=e.value,s=function(e){i.abort(),a||(a=!0,o(e,t,r))};if("remove"==t){var u=i.objectStore(this.storeName)["delete"](r);u.onsuccess=c,u.onerror=s}else if("put"==t){var h;null!==this.keyPath?(this._addIdPropertyIfNeeded(n),h=i.objectStore(this.storeName).put(n)):h=i.objectStore(this.storeName).put(n,r),h.onsuccess=c,h.onerror=s}},this),i},putBatch:function(e,t,r){var n=e.map(function(e){return{type:"put",value:e}});return this.batch(n,t,r)},removeBatch:function(e,t,r){var n=e.map(function(e){return{type:"remove",key:e}});return this.batch(n,t,r)},getBatch:function(t,r,o,i){o||(o=e),r||(r=n),i||(i="sparse"),"[object Array]"!=Object.prototype.toString.call(t)&&o(new Error("keyArray argument must be of type Array."));var s=this.db.transaction([this.storeName],this.consts.READ_ONLY);s.oncomplete=function(){var e=h?r:o;e(l)},s.onabort=o,s.onerror=o;var a=[],u=t.length,c=!1,h=!1,l=null,d=function(e){e.target.result||"dense"==i?a.push(e.target.result):"sparse"==i&&a.length++,u--,0===u&&(c=!0,h=!0,l=a)};return t.forEach(function(e){var t=function(e){c=!0,l=e,o(e),s.abort()},r=s.objectStore(this.storeName).get(e);r.onsuccess=d,r.onerror=t},this),s},getAll:function(t,r){r||(r=e),t||(t=n);var o=this.db.transaction([this.storeName],this.consts.READ_ONLY),i=o.objectStore(this.storeName);return i.getAll?this._getAllNative(o,i,t,r):this._getAllCursor(o,i,t,r),o},_getAllNative:function(e,t,r,n){var o=!1,i=null;e.oncomplete=function(){var e=o?r:n;e(i)},e.onabort=n,e.onerror=n;var s=t.getAll();s.onsuccess=function(e){o=!0,i=e.target.result},s.onerror=n},_getAllCursor:function(e,t,r,n){var o=[],i=!1,s=null;e.oncomplete=function(){var e=i?r:n;e(s)},e.onabort=n,e.onerror=n;var a=t.openCursor();a.onsuccess=function(e){var t=e.target.result;t?(o.push(t.value),t["continue"]()):(i=!0,s=o)},a.onError=n},clear:function(t,r){r||(r=e),t||(t=n);var o=!1,i=null,s=this.db.transaction([this.storeName],this.consts.READ_WRITE);s.oncomplete=function(){var e=o?t:r;e(i)},s.onabort=r,s.onerror=r;var a=s.objectStore(this.storeName).clear();return a.onsuccess=function(e){o=!0,i=e.target.result},a.onerror=r,s},_addIdPropertyIfNeeded:function(e){this.features.hasAutoIncrement||"undefined"!=typeof e[this.keyPath]||(e[this.keyPath]=this._insertIdCount++ +Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(e){return this.store.indexNames.contains(e)},normalizeIndexData:function(e){e.keyPath=e.keyPath||e.name,e.unique=!!e.unique,e.multiEntry=!!e.multiEntry},indexComplies:function(e,t){var r=["keyPath","unique","multiEntry"].every(function(r){if("multiEntry"==r&&void 0===e[r]&&t[r]===!1)return!0;if("keyPath"==r&&"[object Array]"==Object.prototype.toString.call(t[r])){var n=t.keyPath,o=e.keyPath;if("string"==typeof o)return n.toString()==o;if("function"!=typeof o.contains&&"function"!=typeof o.indexOf)return!1;if(o.length!==n.length)return!1;for(var i=0,s=n.length;s>i;i++)if(!(o.contains&&o.contains(n[i])||o.indexOf(-1!==n[i])))return!1;return!0}return t[r]==e[r]});return r},iterate:function(t,r){r=i({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:e},r||{});var n="desc"==r.order.toLowerCase()?"PREV":"NEXT";r.filterDuplicates&&(n+="_NO_DUPLICATE");var o=!1,s=this.db.transaction([this.storeName],this.consts[r.writeAccess?"READ_WRITE":"READ_ONLY"]),a=s.objectStore(this.storeName);r.index&&(a=a.index(r.index)),s.oncomplete=function(){return o?void(r.onEnd?r.onEnd():t(null)):void r.onError(null)},s.onabort=r.onError,s.onerror=r.onError;var u=a.openCursor(r.keyRange,this.consts[n]);return u.onerror=r.onError,u.onsuccess=function(e){var n=e.target.result;n?(t(n.value,n,s),r.autoContinue&&n["continue"]()):o=!0},s},query:function(e,t){var r=[];return t=t||{},t.onEnd=function(){e(r)},this.iterate(function(e){r.push(e)},t)},count:function(t,r){r=i({index:null,keyRange:null},r||{});var n=r.onError||e,o=!1,s=null,a=this.db.transaction([this.storeName],this.consts.READ_ONLY);a.oncomplete=function(){var e=o?t:n;e(s)},a.onabort=n,a.onerror=n;var u=a.objectStore(this.storeName);r.index&&(u=u.index(r.index));var c=u.count(r.keyRange);return c.onsuccess=function(e){o=!0,s=e.target.result},c.onError=n,a},makeKeyRange:function(e){var t,r="undefined"!=typeof e.lower,n="undefined"!=typeof e.upper,o="undefined"!=typeof e.only;switch(!0){case o:t=this.keyRange.only(e.only);break;case r&&n:t=this.keyRange.bound(e.lower,e.upper,e.excludeLower,e.excludeUpper);break;case r:t=this.keyRange.lowerBound(e.lower,e.excludeLower);break;case n:t=this.keyRange.upperBound(e.upper,e.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return t}};var n=function(){},o={},i=function(e,t){var r,n;for(r in t)n=t[r],n!==o[r]&&n!==e[r]&&(e[r]=n);return e};return r.version=r.prototype.version,r},this);